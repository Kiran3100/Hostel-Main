### Combined Content from Folder: D:\Last Github Push\Last\HOStel-back\app\schemas\user ###



# ===== Folder: D:\Last Github Push\Last\HOStel-back\app\schemas\user =====

# --- File: D:\Last Github Push\Last\HOStel-back\app\schemas\user\user_base.py ---
# --- File: app/schemas/user/user_base.py ---
"""
User base schemas with enhanced validation and type safety.
"""

from __future__ import annotations

from datetime import date as Date, datetime
from typing import Optional
from uuid import UUID

from pydantic import EmailStr, Field, field_validator, model_validator

from app.schemas.common.base import (
    BaseCreateSchema,
    BaseResponseSchema,
    BaseSchema,
    BaseUpdateSchema,
)
from app.schemas.common.enums import Gender, UserRole
from app.schemas.common.mixins import AddressMixin, EmergencyContactMixin

__all__ = [
    "UserBase",
    "UserCreate",
    "UserUpdate",
    "UserAddressUpdate",
    "UserEmergencyContactUpdate",
]


class UserBase(BaseSchema):
    """
    Base user schema with core user attributes.
    
    Contains common fields shared across user operations.
    """

    email: EmailStr = Field(
        ...,
        description="Email address (must be unique)",
        examples=["user@example.com"],
    )
    phone: str = Field(
        ...,
        pattern=r"^\+?[1-9]\d{9,14}$",
        description="Phone number (E.164 format recommended)",
        examples=["+919876543210"],
    )
    full_name: str = Field(
        ...,
        min_length=2,
        max_length=255,
        description="Full name",
        examples=["John Doe"],
    )
    user_role: UserRole = Field(
        ...,
        description="User role for authorization",
    )
    gender: Optional[Gender] = Field(
        default=None,
        description="Gender (optional)",
    )
    date_of_birth: Optional[Date] = Field(
        default=None,
        description="Date of birth",
    )
    profile_image_url: Optional[str] = Field(
        default=None,
        description="Profile image URL",
        examples=["https://example.com/images/profile.jpg"],
    )

    @field_validator("email")
    @classmethod
    def normalize_email(cls, v: EmailStr) -> str:
        """Normalize email to lowercase and trim whitespace."""
        return v.lower().strip()

    @field_validator("phone")
    @classmethod
    def normalize_phone(cls, v: str) -> str:
        """Normalize phone number by removing spaces and dashes."""
        return v.replace(" ", "").replace("-", "").strip()

    @field_validator("full_name")
    @classmethod
    def validate_full_name(cls, v: str) -> str:
        """
        Validate and normalize full name.
        
        Ensures name is properly formatted and contains valid characters.
        """
        v = v.strip()
        if len(v) < 2:
            raise ValueError("Full name must be at least 2 characters")
        if v.isdigit():
            raise ValueError("Full name cannot be only numbers")
        # Remove excessive whitespace
        v = " ".join(v.split())
        return v

    @field_validator("date_of_birth")
    @classmethod
    def validate_age(cls, v: Optional[Date]) -> Optional[Date]:
        """
        Validate user age constraints.
        
        Ensures user is at least 16 years old and date is not in the future.
        """
        if v is None:
            return v

        today = Date.today()
        
        # Check if date is in the future
        if v >= today:
            raise ValueError("Date of birth cannot be in the future")

        # Calculate age
        age = today.year - v.year - ((today.month, today.day) < (v.month, v.day))
        
        if age < 16:
            raise ValueError("User must be at least 16 years old")
        if age > 100:
            raise ValueError("Invalid date of birth (age exceeds 100 years)")

        return v

    @field_validator("profile_image_url")
    @classmethod
    def validate_image_url(cls, v: Optional[str]) -> Optional[str]:
        """Validate profile image URL format."""
        if v is not None:
            v = v.strip()
            if v and not (v.startswith("http://") or v.startswith("https://")):
                raise ValueError("Profile image URL must start with http:// or https://")
        return v


class UserCreate(UserBase, BaseCreateSchema):
    """
    Create user schema with password validation.
    
    Used for creating new user accounts.
    """

    password: str = Field(
        ...,
        min_length=8,
        max_length=128,
        description="Password (min 8 chars with complexity requirements)",
    )

    @field_validator("password")
    @classmethod
    def validate_password_strength(cls, v: str) -> str:
        """
        Validate password meets strength requirements.
        
        Requirements:
        - Minimum 8 characters
        - At least one digit
        - At least one uppercase letter
        - At least one lowercase letter
        """
        if len(v) < 8:
            raise ValueError("Password must be at least 8 characters long")
        if not any(c.isdigit() for c in v):
            raise ValueError("Password must contain at least one digit")
        if not any(c.isupper() for c in v):
            raise ValueError("Password must contain at least one uppercase letter")
        if not any(c.islower() for c in v):
            raise ValueError("Password must contain at least one lowercase letter")
        return v


class UserUpdate(BaseUpdateSchema):
    """
    Update user schema with all fields optional.
    
    Used for partial updates to user profiles.
    """

    email: Optional[EmailStr] = Field(
        default=None,
        description="Email address",
    )
    phone: Optional[str] = Field(
        default=None,
        pattern=r"^\+?[1-9]\d{9,14}$",
        description="Phone number",
    )
    full_name: Optional[str] = Field(
        default=None,
        min_length=2,
        max_length=255,
        description="Full name",
    )
    gender: Optional[Gender] = Field(
        default=None,
        description="Gender",
    )
    date_of_birth: Optional[Date] = Field(
        default=None,
        description="Date of birth",
    )
    profile_image_url: Optional[str] = Field(
        default=None,
        description="Profile image URL",
    )
    is_active: Optional[bool] = Field(
        default=None,
        description="Account active status",
    )

    @field_validator("email")
    @classmethod
    def normalize_email(cls, v: Optional[EmailStr]) -> Optional[str]:
        """Normalize email to lowercase and trim whitespace."""
        if v is not None:
            return v.lower().strip()
        return v

    @field_validator("phone")
    @classmethod
    def normalize_phone(cls, v: Optional[str]) -> Optional[str]:
        """Normalize phone number by removing spaces and dashes."""
        if v is not None:
            return v.replace(" ", "").replace("-", "").strip()
        return v

    @field_validator("full_name")
    @classmethod
    def validate_full_name(cls, v: Optional[str]) -> Optional[str]:
        """Validate and normalize full name."""
        if v is not None:
            v = v.strip()
            if len(v) < 2:
                raise ValueError("Full name must be at least 2 characters")
            if v.isdigit():
                raise ValueError("Full name cannot be only numbers")
            v = " ".join(v.split())
        return v

    @field_validator("date_of_birth")
    @classmethod
    def validate_age(cls, v: Optional[Date]) -> Optional[Date]:
        """Validate user age constraints."""
        if v is not None:
            today = Date.today()
            if v >= today:
                raise ValueError("Date of birth cannot be in the future")

            age = today.year - v.year - ((today.month, today.day) < (v.month, v.day))
            if age < 16:
                raise ValueError("User must be at least 16 years old")
            if age > 100:
                raise ValueError("Invalid date of birth")
        return v

    @field_validator("profile_image_url")
    @classmethod
    def validate_image_url(cls, v: Optional[str]) -> Optional[str]:
        """Validate profile image URL format."""
        if v is not None:
            v = v.strip()
            if v and not (v.startswith("http://") or v.startswith("https://")):
                raise ValueError("Profile image URL must start with http:// or https://")
        return v


class UserAddressUpdate(AddressMixin, BaseUpdateSchema):
    """
    Update user address information.
    
    Inherits address fields from AddressMixin.
    """

    # Override to make all fields optional for updates
    address_line1: Optional[str] = Field(
        default=None,
        min_length=5,
        max_length=255,
        description="Address line 1",
    )
    address_line2: Optional[str] = Field(
        default=None,
        max_length=255,
        description="Address line 2",
    )
    city: Optional[str] = Field(
        default=None,
        min_length=2,
        max_length=100,
        description="City",
    )
    state: Optional[str] = Field(
        default=None,
        min_length=2,
        max_length=100,
        description="State",
    )
    pincode: Optional[str] = Field(
        default=None,
        pattern=r"^\d{6}$",
        description="6-digit pincode",
    )
    country: Optional[str] = Field(
        default=None,
        min_length=2,
        max_length=100,
        description="Country",
    )


class UserEmergencyContactUpdate(EmergencyContactMixin, BaseUpdateSchema):
    """
    Update emergency contact information.
    
    Inherits emergency contact fields from EmergencyContactMixin.
    """

    # Override to make all fields optional for updates
    emergency_contact_name: Optional[str] = Field(
        default=None,
        description="Emergency contact name",
    )
    emergency_contact_phone: Optional[str] = Field(
        default=None,
        pattern=r"^\+?[1-9]\d{9,14}$",
        description="Emergency contact phone",
    )
    emergency_contact_relation: Optional[str] = Field(
        default=None,
        description="Relation to user",
    )

    @field_validator("emergency_contact_phone")
    @classmethod
    def normalize_phone(cls, v: Optional[str]) -> Optional[str]:
        """Normalize phone number by removing spaces and dashes."""
        if v is not None:
            return v.replace(" ", "").replace("-", "").strip()
        return v

# --- File: D:\Last Github Push\Last\HOStel-back\app\schemas\user\user_profile.py ---
# --- File: app/schemas/user/user_profile.py ---
"""
User profile update schemas with comprehensive field validation.
"""

from __future__ import annotations

from datetime import date as Date
from typing import Optional

from pydantic import EmailStr, Field, HttpUrl, field_validator

from app.schemas.common.base import BaseUpdateSchema
from app.schemas.common.enums import Gender

__all__ = [
    "ProfileUpdate",
    "ProfileImageUpdate",
    "ContactInfoUpdate",
    "NotificationPreferencesUpdate",
]


class ProfileUpdate(BaseUpdateSchema):
    """
    Update user profile information.
    
    Comprehensive profile update with personal and address information.
    """

    full_name: Optional[str] = Field(
        default=None,
        min_length=2,
        max_length=255,
        description="Full name",
        examples=["John Doe"],
    )
    gender: Optional[Gender] = Field(
        default=None,
        description="Gender",
    )
    date_of_birth: Optional[Date] = Field(
        default=None,
        description="Date of birth",
    )
    address_line1: Optional[str] = Field(
        default=None,
        min_length=5,
        max_length=255,
        description="Address line 1",
    )
    address_line2: Optional[str] = Field(
        default=None,
        max_length=255,
        description="Address line 2 (optional)",
    )
    city: Optional[str] = Field(
        default=None,
        min_length=2,
        max_length=100,
        description="City",
    )
    state: Optional[str] = Field(
        default=None,
        min_length=2,
        max_length=100,
        description="State",
    )
    pincode: Optional[str] = Field(
        default=None,
        pattern=r"^\d{6}$",
        description="6-digit pincode",
    )
    country: Optional[str] = Field(
        default=None,
        min_length=2,
        max_length=100,
        description="Country",
    )

    @field_validator("full_name")
    @classmethod
    def validate_full_name(cls, v: Optional[str]) -> Optional[str]:
        """Validate and normalize full name."""
        if v is not None:
            v = v.strip()
            if len(v) < 2:
                raise ValueError("Full name must be at least 2 characters")
            if v.isdigit():
                raise ValueError("Full name cannot be only numbers")
            # Remove excessive whitespace
            v = " ".join(v.split())
        return v

    @field_validator("date_of_birth")
    @classmethod
    def validate_age(cls, v: Optional[Date]) -> Optional[Date]:
        """Validate date of birth for reasonable age constraints."""
        if v is not None:
            today = Date.today()
            if v >= today:
                raise ValueError("Date of birth cannot be in the future")

            age = today.year - v.year - ((today.month, today.day) < (v.month, v.day))
            if age < 16:
                raise ValueError("User must be at least 16 years old")
            if age > 100:
                raise ValueError("Invalid date of birth")
        return v

    @field_validator("city", "state", "country")
    @classmethod
    def validate_text_fields(cls, v: Optional[str]) -> Optional[str]:
        """Validate and normalize text fields."""
        if v is not None:
            v = v.strip()
            if v.isdigit():
                raise ValueError("Field cannot be only numbers")
            v = " ".join(v.split())
        return v


class ProfileImageUpdate(BaseUpdateSchema):
    """
    Update user profile image.
    
    Validates and updates the profile image URL.
    """

    profile_image_url: HttpUrl = Field(
        ...,
        description="Profile image URL (must be valid HTTP/HTTPS URL)",
        examples=["https://example.com/images/profile.jpg"],
    )


class ContactInfoUpdate(BaseUpdateSchema):
    """
    Update user contact information.
    
    Includes phone, email, and emergency contact details.
    """

    phone: Optional[str] = Field(
        default=None,
        pattern=r"^\+?[1-9]\d{9,14}$",
        description="Phone number (E.164 format recommended)",
        examples=["+919876543210"],
    )
    email: Optional[EmailStr] = Field(
        default=None,
        description="Email address",
        examples=["user@example.com"],
    )
    emergency_contact_name: Optional[str] = Field(
        default=None,
        min_length=2,
        max_length=255,
        description="Emergency contact name",
    )
    emergency_contact_phone: Optional[str] = Field(
        default=None,
        pattern=r"^\+?[1-9]\d{9,14}$",
        description="Emergency contact phone number",
    )
    emergency_contact_relation: Optional[str] = Field(
        default=None,
        min_length=2,
        max_length=100,
        description="Relation to emergency contact",
        examples=["Father", "Mother", "Spouse", "Friend"],
    )

    @field_validator("phone", "emergency_contact_phone")
    @classmethod
    def normalize_phone(cls, v: Optional[str]) -> Optional[str]:
        """Normalize phone number by removing spaces and dashes."""
        if v is not None:
            return v.replace(" ", "").replace("-", "").strip()
        return v

    @field_validator("email")
    @classmethod
    def normalize_email(cls, v: Optional[EmailStr]) -> Optional[str]:
        """Normalize email to lowercase and trim whitespace."""
        if v is not None:
            return v.lower().strip()
        return v

    @field_validator("emergency_contact_name", "emergency_contact_relation")
    @classmethod
    def validate_text_fields(cls, v: Optional[str]) -> Optional[str]:
        """Validate and normalize text fields."""
        if v is not None:
            v = v.strip()
            if v.isdigit():
                raise ValueError("Field cannot be only numbers")
            v = " ".join(v.split())
        return v


class NotificationPreferencesUpdate(BaseUpdateSchema):
    """
    Update user notification preferences.
    
    Granular control over different notification channels and types.
    """

    # Channel preferences
    email_notifications: bool = Field(
        default=True,
        description="Enable email notifications",
    )
    sms_notifications: bool = Field(
        default=True,
        description="Enable SMS notifications",
    )
    push_notifications: bool = Field(
        default=True,
        description="Enable push notifications",
    )

    # Notification type preferences
    booking_notifications: bool = Field(
        default=True,
        description="Receive booking-related notifications",
    )
    payment_notifications: bool = Field(
        default=True,
        description="Receive payment notifications",
    )
    complaint_notifications: bool = Field(
        default=True,
        description="Receive complaint status updates",
    )
    announcement_notifications: bool = Field(
        default=True,
        description="Receive hostel announcements",
    )
    maintenance_notifications: bool = Field(
        default=True,
        description="Receive maintenance updates",
    )
    marketing_notifications: bool = Field(
        default=False,
        description="Receive marketing communications (opt-in)",
    )

    # Advanced preferences
    digest_frequency: Optional[str] = Field(
        default=None,
        pattern=r"^(immediate|daily|weekly|never)$",
        description="Notification digest frequency",
        examples=["immediate", "daily", "weekly", "never"],
    )
    quiet_hours_start: Optional[str] = Field(
        default=None,
        pattern=r"^([01]?[0-9]|2[0-3]):[0-5][0-9]$",
        description="Quiet hours start time (HH:MM format)",
        examples=["22:00"],
    )
    quiet_hours_end: Optional[str] = Field(
        default=None,
        pattern=r"^([01]?[0-9]|2[0-3]):[0-5][0-9]$",
        description="Quiet hours end time (HH:MM format)",
        examples=["08:00"],
    )

    @field_validator("digest_frequency")
    @classmethod
    def normalize_digest_frequency(cls, v: Optional[str]) -> Optional[str]:
        """Normalize digest frequency to lowercase."""
        if v is not None:
            return v.lower().strip()
        return v

# --- File: D:\Last Github Push\Last\HOStel-back\app\schemas\user\user_response.py ---
# --- File: app/schemas/user/user_response.py ---
"""
User response schemas with comprehensive user information.
"""

from __future__ import annotations

from datetime import date as Date, datetime
from typing import Optional
from uuid import UUID

from pydantic import Field

from app.schemas.common.base import BaseResponseSchema, BaseSchema
from app.schemas.common.enums import Gender, UserRole

__all__ = [
    "UserResponse",
    "UserDetail",
    "UserListItem",
    "UserProfile",
    "UserStats",
]


class UserResponse(BaseResponseSchema):
    """
    Standard user response schema.
    
    Returns essential user information for general API responses.
    """

    email: str = Field(
        ...,
        description="Email address",
    )
    phone: str = Field(
        ...,
        description="Phone number",
    )
    full_name: str = Field(
        ...,
        description="Full name",
    )
    user_role: UserRole = Field(
        ...,
        description="User role",
    )
    is_active: bool = Field(
        ...,
        description="Account active status",
    )
    is_email_verified: bool = Field(
        ...,
        description="Email verification status",
    )
    is_phone_verified: bool = Field(
        ...,
        description="Phone verification status",
    )
    profile_image_url: Optional[str] = Field(
        default=None,
        description="Profile image URL",
    )
    last_login_at: Optional[datetime] = Field(
        default=None,
        description="Last login timestamp (UTC)",
    )


class UserDetail(BaseResponseSchema):
    """
    Detailed user information schema.
    
    Comprehensive user profile with all available information.
    """

    # Basic information
    email: str = Field(..., description="Email address")
    phone: str = Field(..., description="Phone number")
    full_name: str = Field(..., description="Full name")
    user_role: UserRole = Field(..., description="User role")
    gender: Optional[Gender] = Field(default=None, description="Gender")
    date_of_birth: Optional[Date] = Field(default=None, description="Date of birth")
    profile_image_url: Optional[str] = Field(
        default=None,
        description="Profile image URL",
    )

    # Address information
    address_line1: Optional[str] = Field(
        default=None,
        description="Address line 1",
    )
    address_line2: Optional[str] = Field(
        default=None,
        description="Address line 2",
    )
    city: Optional[str] = Field(default=None, description="City")
    state: Optional[str] = Field(default=None, description="State")
    country: Optional[str] = Field(default=None, description="Country")
    pincode: Optional[str] = Field(default=None, description="Pincode")

    # Emergency contact
    emergency_contact_name: Optional[str] = Field(
        default=None,
        description="Emergency contact name",
    )
    emergency_contact_phone: Optional[str] = Field(
        default=None,
        description="Emergency contact phone",
    )
    emergency_contact_relation: Optional[str] = Field(
        default=None,
        description="Relation to emergency contact",
    )

    # Account status
    is_active: bool = Field(..., description="Account active status")
    is_email_verified: bool = Field(..., description="Email verification status")
    is_phone_verified: bool = Field(..., description="Phone verification status")
    email_verified_at: Optional[datetime] = Field(
        default=None,
        description="Email verification timestamp",
    )
    phone_verified_at: Optional[datetime] = Field(
        default=None,
        description="Phone verification timestamp",
    )
    last_login_at: Optional[datetime] = Field(
        default=None,
        description="Last login timestamp",
    )
    last_password_change_at: Optional[datetime] = Field(
        default=None,
        description="Last password change timestamp",
    )


class UserListItem(BaseSchema):
    """
    User list item schema.
    
    Minimal user information for list views and search results.
    """

    id: UUID = Field(..., description="User ID")
    email: str = Field(..., description="Email address")
    full_name: str = Field(..., description="Full name")
    user_role: UserRole = Field(..., description="User role")
    is_active: bool = Field(..., description="Account active status")
    profile_image_url: Optional[str] = Field(
        default=None,
        description="Profile image URL",
    )
    created_at: datetime = Field(..., description="Registration date")
    last_login_at: Optional[datetime] = Field(
        default=None,
        description="Last login timestamp",
    )


class UserProfile(BaseSchema):
    """
    Public user profile schema.
    
    Limited information suitable for public display.
    """

    id: UUID = Field(..., description="User ID")
    full_name: str = Field(..., description="Full name")
    profile_image_url: Optional[str] = Field(
        default=None,
        description="Profile image URL",
    )
    user_role: UserRole = Field(..., description="User role")
    member_since: datetime = Field(
        ...,
        description="Member since (registration date)",
    )


class UserStats(BaseSchema):
    """
    User statistics schema.
    
    Aggregate statistics about user activity and engagement.
    """

    user_id: UUID = Field(..., description="User ID")
    total_bookings: int = Field(
        default=0,
        ge=0,
        description="Total number of bookings",
    )
    active_bookings: int = Field(
        default=0,
        ge=0,
        description="Number of active bookings",
    )
    completed_bookings: int = Field(
        default=0,
        ge=0,
        description="Number of completed bookings",
    )
    total_payments: int = Field(
        default=0,
        ge=0,
        description="Total number of payments",
    )
    total_amount_paid: float = Field(
        default=0.0,
        ge=0,
        description="Total amount paid (in currency)",
    )
    total_complaints: int = Field(
        default=0,
        ge=0,
        description="Total number of complaints raised",
    )
    resolved_complaints: int = Field(
        default=0,
        ge=0,
        description="Number of resolved complaints",
    )
    average_rating_given: Optional[float] = Field(
        default=None,
        ge=0,
        le=5,
        description="Average rating given to hostels",
    )
    account_age_days: int = Field(
        ...,
        ge=0,
        description="Account age in days",
    )
    last_activity_at: Optional[datetime] = Field(
        default=None,
        description="Last activity timestamp",
    )

# --- File: D:\Last Github Push\Last\HOStel-back\app\schemas\user\user_session.py ---
# --- File: app/schemas/user/user_session.py ---
"""
User session schemas with enhanced tracking and management.
"""

from __future__ import annotations

from datetime import datetime
from typing import Dict, List, Optional
from uuid import UUID

from pydantic import Field, IPvAnyAddress, field_validator

from app.schemas.common.base import BaseCreateSchema, BaseResponseSchema, BaseSchema

__all__ = [
    "UserSession",
    "SessionInfo",
    "ActiveSessionsList",
    "RevokeSessionRequest",
    "RevokeAllSessionsRequest",
    "CreateSessionRequest",
]


class UserSession(BaseResponseSchema):
    """
    User session database model representation.
    
    Persistent session information stored in database.
    """

    user_id: UUID = Field(
        ...,
        description="User ID associated with session",
    )
    device_info: Optional[Dict[str, str]] = Field(
        default=None,
        description="Device information (user agent, platform, etc.)",
    )
    ip_address: Optional[str] = Field(
        default=None,
        description="IP address from which session was created",
    )
    is_revoked: bool = Field(
        default=False,
        description="Whether session has been revoked",
    )
    expires_at: datetime = Field(
        ...,
        description="Session expiration timestamp (UTC)",
    )
    last_activity: datetime = Field(
        ...,
        description="Last activity timestamp (UTC)",
    )


class SessionInfo(BaseSchema):
    """
    Session information for display to users.
    
    Enhanced session details for frontend presentation.
    """

    session_id: UUID = Field(
        ...,
        description="Unique session identifier",
    )
    device_name: Optional[str] = Field(
        default=None,
        description="Device name/description",
        examples=["iPhone 13", "Chrome on Windows"],
    )
    device_type: Optional[str] = Field(
        default=None,
        description="Device category",
        examples=["mobile", "desktop", "tablet"],
    )
    browser: Optional[str] = Field(
        default=None,
        description="Browser name and version",
        examples=["Chrome 120.0", "Safari 17.1"],
    )
    os: Optional[str] = Field(
        default=None,
        description="Operating system",
        examples=["Windows 11", "macOS 14.0", "iOS 17.0"],
    )
    ip_address: Optional[str] = Field(
        default=None,
        description="IP address (masked for privacy)",
        examples=["192.168.1.***"],
    )
    location: Optional[str] = Field(
        default=None,
        description="Approximate location (city, country)",
        examples=["Mumbai, India", "New York, USA"],
    )
    is_current: bool = Field(
        default=False,
        description="Whether this is the current session",
    )
    created_at: datetime = Field(
        ...,
        description="Session creation timestamp",
    )
    last_activity: datetime = Field(
        ...,
        description="Last activity timestamp",
    )
    expires_at: datetime = Field(
        ...,
        description="Session expiration timestamp",
    )


class ActiveSessionsList(BaseSchema):
    """
    List of active user sessions.
    
    Response schema for retrieving all active sessions.
    """

    sessions: List[SessionInfo] = Field(
        ...,
        description="List of active sessions",
    )
    total_sessions: int = Field(
        ...,
        ge=0,
        description="Total number of active sessions",
    )
    current_session_id: Optional[UUID] = Field(
        default=None,
        description="ID of the current session making the request",
    )


class RevokeSessionRequest(BaseCreateSchema):
    """
    Request to revoke a specific session.
    
    Used to terminate a single session by ID.
    """

    session_id: UUID = Field(
        ...,
        description="Session ID to revoke",
    )


class RevokeAllSessionsRequest(BaseCreateSchema):
    """
    Request to revoke all sessions.
    
    Option to keep current session active for security.
    """

    keep_current: bool = Field(
        default=True,
        description="Keep current session active after revoking others",
    )
    reason: Optional[str] = Field(
        default=None,
        max_length=500,
        description="Reason for revoking all sessions (optional)",
        examples=["Security concern", "Lost device"],
    )


class CreateSessionRequest(BaseCreateSchema):
    """
    Request to create a new session.
    
    Used during login to track session information.
    """

    user_id: UUID = Field(
        ...,
        description="User ID for the session",
    )
    device_info: Optional[Dict[str, str]] = Field(
        default=None,
        description="Device information",
    )
    ip_address: Optional[str] = Field(
        default=None,
        description="IP address",
    )
    user_agent: Optional[str] = Field(
        default=None,
        max_length=500,
        description="User agent string",
    )
    remember_me: bool = Field(
        default=False,
        description="Whether to extend session duration",
    )

    @field_validator("ip_address")
    @classmethod
    def validate_ip_address(cls, v: Optional[str]) -> Optional[str]:
        """Validate IP address format."""
        if v is not None:
            v = v.strip()
            # Basic IP validation - can be enhanced
            if v and not (
                v.replace(".", "").replace(":", "").isalnum()
            ):
                raise ValueError("Invalid IP address format")
        return v

# --- File: D:\Last Github Push\Last\HOStel-back\app\schemas\user\__init__.py ---
# --- File: app/schemas/user/__init__.py ---
"""
User schemas package.

Re-exports commonly used user-related schemas for convenient imports.

Example:
    from app.schemas.user import UserCreate, UserResponse, ProfileUpdate
"""

from __future__ import annotations

from app.schemas.user.user_base import (
    UserAddressUpdate,
    UserBase,
    UserCreate,
    UserEmergencyContactUpdate,
    UserUpdate,
)
from app.schemas.user.user_profile import (
    ContactInfoUpdate,
    NotificationPreferencesUpdate,
    ProfileImageUpdate,
    ProfileUpdate,
)
from app.schemas.user.user_response import (
    UserDetail,
    UserListItem,
    UserProfile,
    UserResponse,
    UserStats,
)
from app.schemas.user.user_session import (
    ActiveSessionsList,
    CreateSessionRequest,
    RevokeAllSessionsRequest,
    RevokeSessionRequest,
    SessionInfo,
    UserSession,
)

__all__ = [
    # Base
    "UserBase",
    "UserCreate",
    "UserUpdate",
    "UserAddressUpdate",
    "UserEmergencyContactUpdate",
    # Profile
    "ProfileUpdate",
    "ProfileImageUpdate",
    "ContactInfoUpdate",
    "NotificationPreferencesUpdate",
    # Response
    "UserResponse",
    "UserDetail",
    "UserListItem",
    "UserProfile",
    "UserStats",
    # Session
    "UserSession",
    "SessionInfo",
    "ActiveSessionsList",
    "RevokeSessionRequest",
    "RevokeAllSessionsRequest",
    "CreateSessionRequest",
]


# ===== Folder: D:\Last Github Push\Last\HOStel-back\app\schemas\user\__pycache__ =====

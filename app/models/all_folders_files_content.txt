### Combined Content from Folder: D:\Last Github Push\Last\Hostel-Main\app\models ###



# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\base.py ---
# models/base.py
from __future__ import annotations

from datetime import datetime
from uuid import UUID, uuid4

from sqlalchemy import DateTime, String
from sqlalchemy.orm import DeclarativeBase, Mapped, mapped_column

from .mixins.timestamp_mixin import TimestampMixin
from .mixins.soft_delete_mixin import SoftDeleteMixin
from .mixins.audit_mixin import AuditMixin
from .mixins.backend_sync_mixin import BackendSyncMixin
from .mixins.validation_mixin import ValidationMixin


class Base(DeclarativeBase):
    """Root SQLAlchemy base class."""
    pass


class BaseEntity(
    Base,
    TimestampMixin,
    SoftDeleteMixin,
    AuditMixin,
    ValidationMixin,
):
    """
    Base for most internal entities.

    - UUID primary key
    - 'type' discriminator (optional usage)
    - created_at / updated_at
    - soft delete
    - audit fields
    """
    __abstract__ = True

    id: Mapped[UUID] = mapped_column(
        primary_key=True,
        default=uuid4,
        unique=True,
    )
    type: Mapped[str] = mapped_column(String(50), default=lambda: "entity")

    # TimestampMixin & others supply remaining columns


class BaseItem(
    BaseEntity,
    BackendSyncMixin,
):
    """
    Base for items that have a backing record in an external system.

    Adds:
    - backend_id: str (for sync)
    """
    __abstract__ = True


class BaseVisitorItem(
    Base,
    TimestampMixin,
    ValidationMixin,
):
    """
    Base for visitor-facing models (public side, not tied to internal audit/soft delete).
    """
    __abstract__ = True

    id: Mapped[UUID] = mapped_column(
        primary_key=True,
        default=uuid4,
        unique=True,
    )
    type: Mapped[str] = mapped_column(String(50), default=lambda: "visitor_item")

    def to_dict(self) -> dict:
        return {c.key: getattr(self, c.key) for c in self.__table__.columns}

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\__init__.py ---
# models/__init__.py
from .base import Base, BaseEntity, BaseItem, BaseVisitorItem

__all__ = [
    "Base",
    "BaseEntity",
    "BaseItem",
    "BaseVisitorItem",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\analytics =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\analytics\analytics_data.py ---
# app.models/analytics/analytics_data.py
from __future__ import annotations

from datetime import datetime
from decimal import Decimal
from uuid import UUID

from sqlalchemy import DateTime, Numeric, Integer, String
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class AnalyticsData(BaseItem):
    """
    High-level platform analytics (visitors, conversion, retention).
    """
    __tablename__ = "analytics_data"

    # Scope (platform-wide)
    period_start: Mapped[datetime] = mapped_column(DateTime(timezone=True))
    period_end: Mapped[datetime] = mapped_column(DateTime(timezone=True))

    total_visitors: Mapped[int] = mapped_column(Integer, default=0)
    conversion_rate: Mapped[Decimal] = mapped_column(Numeric(5, 2), default=0)
    avg_session_time_seconds: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)
    total_bookings: Mapped[int] = mapped_column(Integer, default=0)
    avg_booking_value: Mapped[Decimal] = mapped_column(Numeric(12, 2), default=0)
    cancellation_rate: Mapped[Decimal] = mapped_column(Numeric(5, 2), default=0)
    retention_rate: Mapped[Decimal] = mapped_column(Numeric(5, 2), default=0)
    avg_stay_duration_days: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)
    repeat_bookings_rate: Mapped[Decimal] = mapped_column(Numeric(5, 2), default=0)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\analytics\dashboard_metrics.py ---
# app.models/analytics/dashboard_metrics.py
from __future__ import annotations

from datetime import datetime, date
from decimal import Decimal
from uuid import UUID

from sqlalchemy import Date, DateTime, Numeric, Integer, String
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class DashboardMetrics(BaseItem):
    """
    Aggregated dashboard metrics (hostel/platform/admin scope).
    Mirrors DashboardMetrics schema.
    """
    __tablename__ = "analytics_dashboard_metrics"

    scope_type: Mapped[str] = mapped_column(
        String(20)
    )  # hostel | platform | admin
    scope_id: Mapped[UUID | None] = mapped_column(nullable=True)

    period_start: Mapped[date] = mapped_column(Date)
    period_end: Mapped[date] = mapped_column(Date)
    generated_at: Mapped[datetime] = mapped_column(DateTime(timezone=True))

    # Quick stats (simplified)
    total_hostels: Mapped[int] = mapped_column(Integer, default=0)
    active_hostels: Mapped[int] = mapped_column(Integer, default=0)
    total_students: Mapped[int] = mapped_column(Integer, default=0)
    active_students: Mapped[int] = mapped_column(Integer, default=0)
    total_visitors: Mapped[int] = mapped_column(Integer, default=0)

    todays_check_ins: Mapped[int] = mapped_column(Integer, default=0)
    todays_check_outs: Mapped[int] = mapped_column(Integer, default=0)

    open_complaints: Mapped[int] = mapped_column(Integer, default=0)
    pending_maintenance: Mapped[int] = mapped_column(Integer, default=0)

    todays_revenue: Mapped[Decimal] = mapped_column(Numeric(12, 2), default=0)
    monthly_revenue: Mapped[Decimal] = mapped_column(Numeric(12, 2), default=0)
    outstanding_payments: Mapped[Decimal] = mapped_column(Numeric(12, 2), default=0)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\analytics\performance_metrics.py ---
# app.models/analytics/performance_metrics.py
from __future__ import annotations

from datetime import date
from decimal import Decimal
from uuid import UUID

from sqlalchemy import Date, Numeric, Integer
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class SupervisorPerformanceMetrics(BaseItem):
    """
    High-level performance metrics per supervisor (for analytics).
    """
    __tablename__ = "analytics_supervisor_performance"

    supervisor_id: Mapped[UUID] = mapped_column(index=True)
    hostel_id: Mapped[UUID] = mapped_column(index=True)

    period_start: Mapped[date] = mapped_column(Date)
    period_end: Mapped[date] = mapped_column(Date)

    # Workload/performance (simplified subset)
    complaints_assigned: Mapped[int] = mapped_column(Integer, default=0)
    complaints_resolved: Mapped[int] = mapped_column(Integer, default=0)

    maintenance_requests_created: Mapped[int] = mapped_column(Integer, default=0)
    maintenance_requests_completed: Mapped[int] = mapped_column(Integer, default=0)

    attendance_records_marked: Mapped[int] = mapped_column(Integer, default=0)

    avg_complaint_resolution_time_hours: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)
    avg_maintenance_completion_time_hours: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)

    overall_performance_score: Mapped[Decimal] = mapped_column(Numeric(5, 2), default=0)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\analytics\platform_analytics.py ---
# app.models/analytics/platform_analytics.py
from __future__ import annotations

from datetime import datetime, date
from decimal import Decimal
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, DateTime, Integer, Numeric, String
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class PlatformMetrics(BaseItem):
    """Platform-wide metrics (tenants, users, load)."""
    __tablename__ = "analytics_platform_metrics"

    period_start: Mapped[date] = mapped_column(Date)
    period_end: Mapped[date] = mapped_column(Date)
    generated_at: Mapped[datetime] = mapped_column(DateTime(timezone=True))

    total_hostels: Mapped[int] = mapped_column(Integer, default=0)
    active_hostels: Mapped[int] = mapped_column(Integer, default=0)
    hostels_on_trial: Mapped[int] = mapped_column(Integer, default=0)

    total_users: Mapped[int] = mapped_column(Integer, default=0)
    total_students: Mapped[int] = mapped_column(Integer, default=0)
    total_supervisors: Mapped[int] = mapped_column(Integer, default=0)
    total_admins: Mapped[int] = mapped_column(Integer, default=0)
    total_visitors: Mapped[int] = mapped_column(Integer, default=0)

    avg_daily_active_users: Mapped[int] = mapped_column(Integer, default=0)
    peak_concurrent_sessions: Mapped[int] = mapped_column(Integer, default=0)


class GrowthMetrics(BaseItem):
    """Growth over time for hostels, revenue, users."""
    __tablename__ = "analytics_growth_metrics"

    period_start: Mapped[date] = mapped_column(Date)
    period_end: Mapped[date] = mapped_column(Date)

    new_hostels: Mapped[int] = mapped_column(Integer, default=0)
    churned_hostels: Mapped[int] = mapped_column(Integer, default=0)
    net_hostel_growth: Mapped[int] = mapped_column(Integer, default=0)

    total_revenue: Mapped[Decimal] = mapped_column(Numeric(12, 2), default=0)
    revenue_growth_rate: Mapped[Decimal] = mapped_column(Numeric(5, 2), default=0)

    new_users: Mapped[int] = mapped_column(Integer, default=0)
    user_growth_rate: Mapped[Decimal] = mapped_column(Numeric(5, 2), default=0)


class PlatformUsageAnalytics(BaseItem):
    """API / platform usage metrics."""
    __tablename__ = "analytics_platform_usage"

    period_start: Mapped[date] = mapped_column(Date)
    period_end: Mapped[date] = mapped_column(Date)
    generated_at: Mapped[datetime] = mapped_column(DateTime(timezone=True))

    total_requests: Mapped[int] = mapped_column(Integer, default=0)
    avg_requests_per_minute: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)
    api_error_rate: Mapped[Decimal] = mapped_column(Numeric(5, 2), default=0)

    avg_response_time_ms: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)
    p95_response_time_ms: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)
    p99_response_time_ms: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\analytics\visitor_behavior_analytics.py ---
# app.models/analytics/visitor_behavior_analytics.py
# (Move the previously defined VisitorBehaviorAnalytics here)
from __future__ import annotations

from datetime import datetime
from decimal import Decimal
from typing import List, Optional
from uuid import UUID

from sqlalchemy import DateTime, Float, Integer, JSON, Numeric
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class VisitorBehaviorAnalytics(BaseItem):
    """See previous definition; placed under analytics package."""
    __tablename__ = "analytics_visitor_behavior"

    visitor_id: Mapped[UUID] = mapped_column(index=True)

    total_sessions: Mapped[int] = mapped_column(Integer, default=0)
    total_page_views: Mapped[int] = mapped_column(Integer, default=0)
    avg_session_duration: Mapped[Optional[float]] = mapped_column(Float)
    bounce_rate: Mapped[Optional[Decimal]] = mapped_column(Numeric(5, 2))

    total_searches: Mapped[int] = mapped_column(Integer, default=0)
    most_searched_locations: Mapped[List[str]] = mapped_column(JSON, default=list)
    preferred_price_range: Mapped[Optional[str]] = mapped_column()
    preferred_amenities: Mapped[List[str]] = mapped_column(JSON, default=list)

    hostels_viewed: Mapped[int] = mapped_column(Integer, default=0)
    favorites_added: Mapped[int] = mapped_column(Integer, default=0)
    comparisons_made: Mapped[int] = mapped_column(Integer, default=0)
    inquiries_sent: Mapped[int] = mapped_column(Integer, default=0)
    bookings_made: Mapped[int] = mapped_column(Integer, default=0)
    reviews_written: Mapped[int] = mapped_column(Integer, default=0)

    inquiry_to_booking_rate: Mapped[Optional[Decimal]] = mapped_column(Numeric(5, 2))
    total_booking_value: Mapped[Optional[Decimal]] = mapped_column(Numeric(12, 2))

    last_login: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    last_search: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    last_booking: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\analytics\__init__.py ---
# models/analytics/__init__.py
from .dashboard_metrics import DashboardMetrics
from .analytics_data import AnalyticsData
from .visitor_behavior_analytics import VisitorBehaviorAnalytics
from .platform_analytics import PlatformMetrics, GrowthMetrics, PlatformUsageAnalytics
from .performance_metrics import SupervisorPerformanceMetrics

__all__ = [
    "DashboardMetrics",
    "AnalyticsData",
    "VisitorBehaviorAnalytics",
    "PlatformMetrics",
    "GrowthMetrics",
    "PlatformUsageAnalytics",
    "SupervisorPerformanceMetrics",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\analytics\__pycache__ =====


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\associations =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\associations\admin_hostel.py ---
# app.models/associations/admin_hostel.py
from __future__ import annotations

from datetime import date, datetime
from typing import Optional
from uuid import UUID

from sqlalchemy import Boolean, Date, DateTime, Enum as SAEnum, ForeignKey, JSON
from sqlalchemy.orm import Mapped, mapped_column

from app.schemas.common.enums import PermissionLevel
from app.models.base import BaseEntity


class AdminHostel(BaseEntity):
    """Admin-to-hostel assignments (with permission level)."""
    __tablename__ = "assoc_admin_hostel"

    admin_id: Mapped[UUID] = mapped_column(ForeignKey("core_admin.id"), index=True)
    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)

    permission_level: Mapped[PermissionLevel] = mapped_column(
        SAEnum(PermissionLevel, name="admin_permission_level")
    )
    permissions: Mapped[dict] = mapped_column(JSON, default=dict)

    is_primary: Mapped[bool] = mapped_column(Boolean, default=False)
    is_active: Mapped[bool] = mapped_column(Boolean, default=True)

    assigned_date: Mapped[date] = mapped_column(Date, default=date.today)
    revoked_date: Mapped[Optional[date]] = mapped_column(Date)
    revoke_reason: Mapped[Optional[str]] = mapped_column()
    last_active: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\associations\student_room.py ---
# app.models/associations/student_room.py
from __future__ import annotations

from datetime import date
from decimal import Decimal
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, ForeignKey, Numeric, String
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseEntity


class StudentRoomAssignment(BaseEntity):
    """Student-to-room assignment history."""
    __tablename__ = "assoc_student_room"

    student_id: Mapped[UUID] = mapped_column(ForeignKey("core_student.id"), index=True)
    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)
    room_id: Mapped[UUID] = mapped_column(ForeignKey("core_room.id"), index=True)
    bed_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_bed.id"))

    move_in_date: Mapped[date] = mapped_column(Date)
    move_out_date: Mapped[Optional[date]] = mapped_column(Date)

    rent_amount: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    reason: Mapped[Optional[str]] = mapped_column(String(500))

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\associations\supervisor_hostel.py ---
# app.models/associations/supervisor_hostel.py
from __future__ import annotations

from datetime import date
from typing import Optional
from uuid import UUID

from sqlalchemy import Boolean, Date, ForeignKey, JSON, String
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseEntity


class SupervisorHostel(BaseEntity):
    """Supervisor-to-hostel assignment (multi-hostel support)."""
    __tablename__ = "assoc_supervisor_hostel"

    supervisor_id: Mapped[UUID] = mapped_column(ForeignKey("core_supervisor.id"), index=True)
    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)

    employee_id: Mapped[Optional[str]] = mapped_column(String(100))
    join_date: Mapped[date] = mapped_column(Date)
    employment_type: Mapped[str] = mapped_column(String(50))  # full_time, part_time, contract

    shift_timing: Mapped[Optional[str]] = mapped_column(String(100))
    is_active: Mapped[bool] = mapped_column(Boolean, default=True)

    permissions: Mapped[dict] = mapped_column(JSON, default=dict)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\associations\user_hostel.py ---
# app.models/associations/user_hostel.py
from __future__ import annotations

from datetime import date
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, ForeignKey, String, JSON
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseEntity


class UserHostel(BaseEntity):
    """
    Generic user-hostel association (e.g., last active hostel, favorite hostel, etc.).
    """
    __tablename__ = "assoc_user_hostel"

    user_id: Mapped[UUID] = mapped_column(ForeignKey("core_user.id"), index=True)
    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)

    association_type: Mapped[str] = mapped_column(String(50))  # e.g., 'favorite', 'recent', 'assigned'
    created_date: Mapped[date] = mapped_column(Date, default=date.today)

    metadata_json: Mapped[Optional[dict]] = mapped_column(JSON, nullable=True)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\associations\__init__.py ---
# models/associations/__init__.py
from .admin_hostel import AdminHostel
from .supervisor_hostel import SupervisorHostel
from .student_room import StudentRoomAssignment
from .user_hostel import UserHostel

__all__ = [
    "AdminHostel",
    "SupervisorHostel",
    "StudentRoomAssignment",
    "UserHostel",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\associations\__pycache__ =====


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\audit =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\audit\admin_override.py ---
# models/audit/admin_override.py
from __future__ import annotations

from datetime import datetime
from typing import Dict, Any, Optional
from uuid import UUID

from sqlalchemy import DateTime, JSON, String, ForeignKey
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class AdminOverride(BaseItem):
    """Admin override records (supervisor decisions)."""
    __tablename__ = "audit_admin_override"

    admin_id: Mapped[UUID] = mapped_column(ForeignKey("core_admin.id"))
    supervisor_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_supervisor.id"))
    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"))

    override_type: Mapped[str] = mapped_column(String(100))
    entity_type: Mapped[str] = mapped_column(String(50))
    entity_id: Mapped[UUID] = mapped_column()

    reason: Mapped[str] = mapped_column(String(2000))

    original_action: Mapped[Optional[Dict[str, Any]]] = mapped_column(JSON)
    override_action: Mapped[Dict[str, Any]] = mapped_column(JSON)

    created_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), default=datetime.utcnow)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\audit\audit_log.py ---
# models/audit/audit_log.py
from __future__ import annotations

from datetime import datetime
from typing import Optional, Dict, Any
from uuid import UUID

from sqlalchemy import DateTime, Enum as SAEnum, JSON, String, ForeignKey
from sqlalchemy.orm import Mapped, mapped_column

from app.schemas.common.enums import AuditActionCategory, UserRole
from app.models.base import BaseItem


class AuditLog(BaseItem):
    """General audit trail for actions."""
    __tablename__ = "audit_log"

    user_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_user.id"))
    user_role: Mapped[Optional[UserRole]] = mapped_column(SAEnum(UserRole, name="audit_user_role"))

    action_type: Mapped[str] = mapped_column(String(100))
    action_category: Mapped[AuditActionCategory] = mapped_column(
        SAEnum(AuditActionCategory, name="audit_category")
    )

    entity_type: Mapped[Optional[str]] = mapped_column(String(50))
    entity_id: Mapped[Optional[UUID]] = mapped_column()

    hostel_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_hostel.id"))

    description: Mapped[str] = mapped_column(String(2000))

    old_values: Mapped[Optional[Dict[str, Any]]] = mapped_column(JSON)
    new_values: Mapped[Optional[Dict[str, Any]]] = mapped_column(JSON)

    ip_address: Mapped[Optional[str]] = mapped_column(String(50))
    user_agent: Mapped[Optional[str]] = mapped_column(String(500))
    request_id: Mapped[Optional[str]] = mapped_column(String(100))

    created_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), default=datetime.utcnow)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\audit\supervisor_activity.py ---
# models/audit/supervisor_activity.py
from __future__ import annotations

from datetime import datetime
from typing import Dict, Any, Optional
from uuid import UUID

from sqlalchemy import DateTime, JSON, String, ForeignKey
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class SupervisorActivity(BaseItem):
    """Supervisor action logs."""
    __tablename__ = "audit_supervisor_activity"

    supervisor_id: Mapped[UUID] = mapped_column(ForeignKey("core_supervisor.id"), index=True)
    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)

    action_type: Mapped[str] = mapped_column(String(100))
    action_category: Mapped[str] = mapped_column(String(50))  # complaint, attendance, maintenance, etc.

    entity_type: Mapped[Optional[str]] = mapped_column(String(50))
    entity_id: Mapped[Optional[UUID]] = mapped_column()

    action_description: Mapped[str] = mapped_column(String(2000))
    extra_metadata: Mapped[Dict[str, Any]] = mapped_column(JSON, default=dict)

    ip_address: Mapped[Optional[str]] = mapped_column(String(50))
    user_agent: Mapped[Optional[str]] = mapped_column(String(500))

    created_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), default=datetime.utcnow)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\audit\user_activity.py ---
# models/audit/user_activity.py
from __future__ import annotations

from datetime import datetime
from typing import Optional
from uuid import UUID

from sqlalchemy import DateTime, String, ForeignKey
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class UserActivity(BaseItem):
    """Simplified user activity tracking (logins, important actions)."""
    __tablename__ = "audit_user_activity"

    user_id: Mapped[UUID] = mapped_column(ForeignKey("core_user.id"), index=True)
    activity_type: Mapped[str] = mapped_column(String(100))  # login, logout, booking_created, etc.
    description: Mapped[Optional[str]] = mapped_column(String(1000))

    ip_address: Mapped[Optional[str]] = mapped_column(String(50))
    user_agent: Mapped[Optional[str]] = mapped_column(String(500))

    created_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), default=datetime.utcnow)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\audit\__init__.py ---
# models/audit/__init__.py
from .audit_log import AuditLog
from .supervisor_activity import SupervisorActivity
from .admin_override import AdminOverride
from .user_activity import UserActivity

__all__ = [
    "AuditLog",
    "SupervisorActivity",
    "AdminOverride",
    "UserActivity",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\audit\__pycache__ =====


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\content =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\content\announcement.py ---
# app.models/content/announcement.py
from __future__ import annotations

from datetime import datetime
from typing import List, Optional
from uuid import UUID

from sqlalchemy import Boolean, DateTime, Enum as SAEnum, ForeignKey, JSON, String, Integer
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import AnnouncementCategory, Priority, TargetAudience
from app.models.base import BaseEntity


class Announcement(BaseEntity):
    """Notices & announcements."""
    __tablename__ = "content_announcement"

    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)

    title: Mapped[str] = mapped_column(String(255))
    content: Mapped[str] = mapped_column(String(5000))

    category: Mapped[AnnouncementCategory] = mapped_column(
        SAEnum(AnnouncementCategory, name="announcement_category")
    )
    priority: Mapped[Priority] = mapped_column(SAEnum(Priority, name="announcement_priority"))

    is_urgent: Mapped[bool] = mapped_column(Boolean, default=False)
    is_pinned: Mapped[bool] = mapped_column(Boolean, default=False)

    target_audience: Mapped[TargetAudience] = mapped_column(
        SAEnum(TargetAudience, name="announcement_target_audience")
    )
    target_room_ids: Mapped[List[UUID]] = mapped_column(JSON, default=list)
    target_student_ids: Mapped[List[UUID]] = mapped_column(JSON, default=list)
    target_floor_numbers: Mapped[List[int]] = mapped_column(JSON, default=list)

    attachments: Mapped[List[str]] = mapped_column(JSON, default=list)

    created_by_id: Mapped[UUID] = mapped_column(ForeignKey("core_user.id"))
    created_by_role: Mapped[str] = mapped_column(String(50))

    is_published: Mapped[bool] = mapped_column(Boolean, default=False)
    scheduled_publish_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    published_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    expires_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

    total_recipients: Mapped[int] = mapped_column(Integer, default=0)
    read_count: Mapped[int] = mapped_column(Integer, default=0)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\content\mess_menu.py ---
# app.models/content/mess_menu.py
from __future__ import annotations

from datetime import date, time
from typing import List, Optional
from uuid import UUID

from sqlalchemy import Boolean, Date, Time, ForeignKey, JSON, String
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.models.base import BaseEntity


class MessMenu(BaseEntity):
    """Daily mess menu per hostel."""
    __tablename__ = "content_mess_menu"

    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)
    menu_date: Mapped[date] = mapped_column(Date, index=True)
    day_of_week: Mapped[str] = mapped_column(String(20))

    breakfast_items: Mapped[List[str]] = mapped_column(JSON, default=list)
    lunch_items: Mapped[List[str]] = mapped_column(JSON, default=list)
    snacks_items: Mapped[List[str]] = mapped_column(JSON, default=list)
    dinner_items: Mapped[List[str]] = mapped_column(JSON, default=list)

    breakfast_time: Mapped[Optional[time]] = mapped_column(Time)
    lunch_time: Mapped[Optional[time]] = mapped_column(Time)
    snacks_time: Mapped[Optional[time]] = mapped_column(Time)
    dinner_time: Mapped[Optional[time]] = mapped_column(Time)

    is_special_menu: Mapped[bool] = mapped_column(Boolean, default=False)
    special_occasion: Mapped[Optional[str]] = mapped_column(String(255))

    vegetarian_available: Mapped[bool] = mapped_column(Boolean, default=True)
    non_vegetarian_available: Mapped[bool] = mapped_column(Boolean, default=False)
    vegan_available: Mapped[bool] = mapped_column(Boolean, default=False)
    jain_available: Mapped[bool] = mapped_column(Boolean, default=False)

    hostel: Mapped["Hostel"] = relationship()

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\content\notice.py ---
# app.models/content/notice.py
from __future__ import annotations

from datetime import datetime
from typing import Optional
from uuid import UUID

from sqlalchemy import Boolean, DateTime, Enum as SAEnum, ForeignKey, String
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import AnnouncementCategory, TargetAudience, Priority
from app.models.base import BaseEntity


class Notice(BaseEntity):
    """
    Simpler notice model (from ER doc) for system-wide or hostel-specific notices.
    """
    __tablename__ = "content_notice"

    hostel_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_hostel.id"), nullable=True, index=True)

    notice_title: Mapped[str] = mapped_column(String(255))
    notice_content: Mapped[str] = mapped_column(String(5000))

    category: Mapped[AnnouncementCategory] = mapped_column(
        SAEnum(AnnouncementCategory, name="notice_category")
    )
    target_audience: Mapped[TargetAudience] = mapped_column(
        SAEnum(TargetAudience, name="notice_target_audience")
    )
    priority: Mapped[Priority] = mapped_column(SAEnum(Priority, name="notice_priority"))

    is_urgent: Mapped[bool] = mapped_column(Boolean, default=False)

    published_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    expires_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

    hostel: Mapped[Optional["Hostel"]] = relationship()

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\content\review.py ---
# app.models/content/review.py
from __future__ import annotations

from datetime import datetime, date
from decimal import Decimal
from typing import List, Optional
from uuid import UUID

from sqlalchemy import Boolean, DateTime, Float, Integer, JSON, Numeric, String
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseEntity


class Review(BaseEntity):
    """
    Internal review system (students/users reviewing hostels).
    This complements the public HostelReview on visitor side.
    """
    __tablename__ = "content_review"

    hostel_id: Mapped[UUID] = mapped_column(index=True)
    reviewer_id: Mapped[UUID] = mapped_column(index=True)
    student_id: Mapped[Optional[UUID]] = mapped_column(nullable=True)
    booking_id: Mapped[Optional[UUID]] = mapped_column(nullable=True)

    overall_rating: Mapped[Decimal] = mapped_column(Numeric(3, 1))

    title: Mapped[str] = mapped_column(String(255))
    review_text: Mapped[str] = mapped_column(String(5000))

    cleanliness_rating: Mapped[Optional[int]] = mapped_column()
    food_quality_rating: Mapped[Optional[int]] = mapped_column()
    staff_behavior_rating: Mapped[Optional[int]] = mapped_column()
    security_rating: Mapped[Optional[int]] = mapped_column()
    value_for_money_rating: Mapped[Optional[int]] = mapped_column()
    amenities_rating: Mapped[Optional[int]] = mapped_column()

    photos: Mapped[List[str]] = mapped_column(JSON, default=list)

    is_verified_stay: Mapped[bool] = mapped_column(Boolean, default=False)
    verified_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

    is_approved: Mapped[bool] = mapped_column(Boolean, default=True)
    is_flagged: Mapped[bool] = mapped_column(Boolean, default=False)

    helpful_count: Mapped[int] = mapped_column(Integer, default=0)
    not_helpful_count: Mapped[int] = mapped_column(Integer, default=0)

    created_at_override: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True), nullable=True)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\content\__init__.py ---
# models/content/__init__.py
from .mess_menu import MessMenu
from .announcement import Announcement
from .review import Review
from .notice import Notice

__all__ = [
    "MessMenu",
    "Announcement",
    "Review",
    "Notice",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\content\__pycache__ =====


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\core =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\core\admin.py ---
# models/core/admin.py
from __future__ import annotations

from datetime import datetime
from typing import Optional
from uuid import UUID

from sqlalchemy import Boolean, DateTime, ForeignKey, JSON, String
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.models.base import BaseItem


class Admin(BaseItem):
    """
    Admin model (management users).
    Stored separately to support multi-hostel administration,
    advanced permissions, etc.
    """
    __tablename__ = "core_admin"

    user_id: Mapped[UUID] = mapped_column(
        ForeignKey("core_user.id", ondelete="CASCADE"),
        unique=True,
        nullable=False,
    )

    role: Mapped[str] = mapped_column(String(50), default="hostel_admin")
    status: Mapped[str] = mapped_column(String(50), default="active")

    permissions: Mapped[dict] = mapped_column(JSON, default=dict)
    last_login: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

    user: Mapped["User"] = relationship(back_populates="admin_profile")

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\core\bed.py ---
# models/core/bed.py
from __future__ import annotations

from datetime import date
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, Enum as SAEnum, ForeignKey, Numeric, String
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import BedStatus
from app.models.base import BaseEntity


class Bed(BaseEntity):
    """Individual bed tracking."""
    __tablename__ = "core_bed"

    hostel_id: Mapped[UUID] = mapped_column(
        ForeignKey("core_hostel.id", ondelete="CASCADE"),
        nullable=False,
    )
    room_id: Mapped[UUID] = mapped_column(
        ForeignKey("core_room.id", ondelete="CASCADE"),
        nullable=False,
    )

    bed_number: Mapped[str] = mapped_column(String(10))
    status: Mapped[BedStatus] = mapped_column(SAEnum(BedStatus, name="bed_status"))

    occupied_from: Mapped[Optional[date]] = mapped_column(Date)
    current_student_id: Mapped[Optional[UUID]] = mapped_column(
        ForeignKey("core_student.id", ondelete="SET NULL"),
        nullable=True,
    )

    # Relationships
    hostel: Mapped["Hostel"] = relationship(back_populates="beds")
    room: Mapped["Room"] = relationship(back_populates="beds")
    current_student: Mapped[Optional["Student"]] = relationship(back_populates="current_bed", uselist=False)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\core\hostel.py ---
# models/core/hostel.py
from __future__ import annotations

from datetime import time
from decimal import Decimal
from typing import List, Optional
from uuid import UUID

from sqlalchemy import Boolean, Float, Integer, JSON, Numeric, String, Time, Enum as SAEnum
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import HostelType, HostelStatus
from app.models.base import BaseEntity


class Hostel(BaseEntity):
    """Main Hostel entity."""
    __tablename__ = "core_hostel"

    # Basic
    name: Mapped[str] = mapped_column(String(255), index=True)
    slug: Mapped[str] = mapped_column(String(255), unique=True, index=True)

    description: Mapped[Optional[str]] = mapped_column(String(2000))
    hostel_type: Mapped[HostelType] = mapped_column(SAEnum(HostelType, name="hostel_type"))

    # Contact
    contact_email: Mapped[Optional[str]] = mapped_column(String(255))
    contact_phone: Mapped[str] = mapped_column(String(20))

    # Address
    address_line1: Mapped[str] = mapped_column(String(255))
    address_line2: Mapped[Optional[str]] = mapped_column(String(255))
    city: Mapped[str] = mapped_column(String(100), index=True)
    state: Mapped[str] = mapped_column(String(100), index=True)
    pincode: Mapped[str] = mapped_column(String(6))
    country: Mapped[str] = mapped_column(String(100), default="India")

    # Web / media
    website_url: Mapped[Optional[str]] = mapped_column(String(500))
    cover_image_url: Mapped[Optional[str]] = mapped_column(String(500))
    gallery_images: Mapped[List[str]] = mapped_column(JSON, default=list)
    virtual_tour_url: Mapped[Optional[str]] = mapped_column(String(500))

    # Pricing
    starting_price_monthly: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    currency: Mapped[str] = mapped_column(String(3), default="INR")

    # Features
    amenities: Mapped[List[str]] = mapped_column(JSON, default=list)
    facilities: Mapped[List[str]] = mapped_column(JSON, default=list)
    security_features: Mapped[List[str]] = mapped_column(JSON, default=list)

    # Policies
    rules: Mapped[Optional[str]] = mapped_column(String(5000))
    check_in_time: Mapped[Optional[time]] = mapped_column(Time)
    check_out_time: Mapped[Optional[time]] = mapped_column(Time)
    visitor_policy: Mapped[Optional[str]] = mapped_column(String(1000))
    late_entry_policy: Mapped[Optional[str]] = mapped_column(String(1000))

    # Location metadata
    nearby_landmarks: Mapped[List[dict]] = mapped_column(JSON, default=list)
    connectivity_info: Mapped[Optional[str]] = mapped_column(String(1000))

    # Capacity and status
    total_rooms: Mapped[int] = mapped_column(Integer, default=0)
    total_beds: Mapped[int] = mapped_column(Integer, default=0)
    occupied_beds: Mapped[int] = mapped_column(Integer, default=0)

    average_rating: Mapped[float] = mapped_column(Float, default=0.0)
    total_reviews: Mapped[int] = mapped_column(Integer, default=0)

    is_public: Mapped[bool] = mapped_column(Boolean, default=True)
    is_featured: Mapped[bool] = mapped_column(Boolean, default=False)
    is_verified: Mapped[bool] = mapped_column(Boolean, default=False)
    is_active: Mapped[bool] = mapped_column(Boolean, default=True)
    status: Mapped[HostelStatus] = mapped_column(SAEnum(HostelStatus, name="hostel_status"))

    # Relationships
    rooms: Mapped[List["Room"]] = relationship(back_populates="hostel", cascade="all, delete-orphan")
    beds: Mapped[List["Bed"]] = relationship(back_populates="hostel", cascade="all, delete-orphan")
    students: Mapped[List["Student"]] = relationship(back_populates="hostel")
    supervisors: Mapped[List["Supervisor"]] = relationship(back_populates="hostel")

    def __repr__(self) -> str:
        return f"<Hostel id={self.id} name={self.name!r} city={self.city!r}>"

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\core\room.py ---
# models/core/room.py
from __future__ import annotations

from decimal import Decimal
from typing import List, Optional
from uuid import UUID

from sqlalchemy import Boolean, Integer, Numeric, JSON, String, Enum as SAEnum
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import RoomType, RoomStatus
from app.models.base import BaseEntity


class Room(BaseEntity):
    """Room model with pricing tiers."""
    __tablename__ = "core_room"

    hostel_id: Mapped[UUID] = mapped_column(
        String(36),
        nullable=False,
        index=True,
    )

    room_number: Mapped[str] = mapped_column(String(50), index=True)
    floor_number: Mapped[Optional[int]] = mapped_column(Integer)
    wing: Mapped[Optional[str]] = mapped_column(String(50))

    room_type: Mapped[RoomType] = mapped_column(SAEnum(RoomType, name="room_type"))
    total_beds: Mapped[int] = mapped_column(Integer, default=1)

    price_monthly: Mapped[Decimal] = mapped_column(Numeric(10, 2))
    price_quarterly: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    price_half_yearly: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    price_yearly: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))

    room_size_sqft: Mapped[Optional[int]] = mapped_column(Integer)
    is_ac: Mapped[bool] = mapped_column(Boolean, default=False)
    has_attached_bathroom: Mapped[bool] = mapped_column(Boolean, default=False)
    has_balcony: Mapped[bool] = mapped_column(Boolean, default=False)
    has_wifi: Mapped[bool] = mapped_column(Boolean, default=True)

    amenities: Mapped[List[str]] = mapped_column(JSON, default=list)
    furnishing: Mapped[List[str]] = mapped_column(JSON, default=list)

    is_available_for_booking: Mapped[bool] = mapped_column(Boolean, default=True)
    is_under_maintenance: Mapped[bool] = mapped_column(Boolean, default=False)
    status: Mapped[RoomStatus] = mapped_column(SAEnum(RoomStatus, name="room_status"))

    room_images: Mapped[List[str]] = mapped_column(JSON, default=list)

    # Relationships
    hostel: Mapped["Hostel"] = relationship(back_populates="rooms")
    beds: Mapped[List["Bed"]] = relationship(back_populates="room", cascade="all, delete-orphan")

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\core\student.py ---
# models/core/student.py
from __future__ import annotations

from datetime import date
from decimal import Decimal
from typing import Optional
from uuid import UUID

from sqlalchemy import Boolean, Date, ForeignKey, Numeric, String, Enum as SAEnum
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import StudentStatus, IDProofType, DietaryPreference
from app.models.base import BaseEntity


class Student(BaseEntity):
    """Student profile linked to User and Hostel."""
    __tablename__ = "core_student"

    user_id: Mapped[UUID] = mapped_column(
        ForeignKey("core_user.id", ondelete="CASCADE"),
        unique=True,
        nullable=False,
    )
    hostel_id: Mapped[UUID] = mapped_column(
        ForeignKey("core_hostel.id", ondelete="CASCADE"),
        nullable=False,
        index=True,
    )
    room_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_room.id", ondelete="SET NULL"))
    bed_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_bed.id", ondelete="SET NULL"))

    # Identification
    id_proof_type: Mapped[Optional[IDProofType]] = mapped_column(SAEnum(IDProofType, name="id_proof_type"))
    id_proof_number: Mapped[Optional[str]] = mapped_column(String(50))

    # Guardian
    guardian_name: Mapped[str] = mapped_column(String(255))
    guardian_phone: Mapped[str] = mapped_column(String(20))
    guardian_email: Mapped[Optional[str]] = mapped_column(String(255))
    guardian_relation: Mapped[Optional[str]] = mapped_column(String(50))
    guardian_address: Mapped[Optional[str]] = mapped_column(String(500))

    # Academic / employment (simplified)
    institution_name: Mapped[Optional[str]] = mapped_column(String(255))
    course: Mapped[Optional[str]] = mapped_column(String(255))
    year_of_study: Mapped[Optional[str]] = mapped_column(String(50))

    company_name: Mapped[Optional[str]] = mapped_column(String(255))
    designation: Mapped[Optional[str]] = mapped_column(String(255))

    # Dates / financial
    check_in_date: Mapped[Optional[date]] = mapped_column(Date)
    expected_checkout_date: Mapped[Optional[date]] = mapped_column(Date)
    actual_checkout_date: Mapped[Optional[date]] = mapped_column(Date)

    security_deposit_amount: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)
    monthly_rent_amount: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))

    # Mess
    mess_subscribed: Mapped[bool] = mapped_column(Boolean, default=False)
    dietary_preference: Mapped[Optional[DietaryPreference]] = mapped_column(
        SAEnum(DietaryPreference, name="dietary_preference"),
        nullable=True,
    )
    food_allergies: Mapped[Optional[str]] = mapped_column(String(500))

    # Status
    student_status: Mapped[StudentStatus] = mapped_column(SAEnum(StudentStatus, name="student_status"))

    # Relationships
    user: Mapped["User"] = relationship(back_populates="student_profile")
    hostel: Mapped["Hostel"] = relationship(back_populates="students")
    room: Mapped[Optional["Room"]] = relationship()
    current_bed: Mapped[Optional["Bed"]] = relationship(back_populates="current_student", uselist=False)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\core\supervisor.py ---
# models/core/supervisor.py
from __future__ import annotations

from datetime import date
from typing import Optional
from uuid import UUID

from sqlalchemy import Boolean, Date, Enum as SAEnum, ForeignKey, JSON, String
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import SupervisorStatus, EmploymentType
from app.models.base import BaseEntity


class Supervisor(BaseEntity):
    """Supervisor model with permissions and employment details."""
    __tablename__ = "core_supervisor"

    user_id: Mapped[UUID] = mapped_column(
        ForeignKey("core_user.id", ondelete="CASCADE"),
        unique=True,
        nullable=False,
    )
    hostel_id: Mapped[UUID] = mapped_column(
        ForeignKey("core_hostel.id", ondelete="CASCADE"),
        nullable=False,
        index=True,
    )

    employee_id: Mapped[Optional[str]] = mapped_column(String(100))
    join_date: Mapped[date] = mapped_column(Date)
    employment_type: Mapped[EmploymentType] = mapped_column(SAEnum(EmploymentType, name="employment_type"))
    shift_timing: Mapped[Optional[str]] = mapped_column(String(100))

    status: Mapped[SupervisorStatus] = mapped_column(SAEnum(SupervisorStatus, name="supervisor_status"))
    is_active: Mapped[bool] = mapped_column(Boolean, default=True)

    permissions: Mapped[dict] = mapped_column(JSON, default=dict)

    user: Mapped["User"] = relationship(back_populates="supervisor_profile")
    hostel: Mapped["Hostel"] = relationship(back_populates="supervisors")

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\core\user.py ---
# models/core/user.py
from __future__ import annotations

from datetime import date, datetime
from typing import Optional
from uuid import UUID

from sqlalchemy import Boolean, Date, DateTime, Enum as SAEnum, String
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import UserRole, Gender
from app.models.base import BaseEntity


class User(BaseEntity):
    """
    Unified User model (admin, supervisor, student, visitor, etc.).
    """
    __tablename__ = "core_user"

    email: Mapped[str] = mapped_column(String(255), unique=True, index=True)
    phone: Mapped[str] = mapped_column(String(20), unique=True, index=True)
    full_name: Mapped[str] = mapped_column(String(255))
    user_role: Mapped[UserRole] = mapped_column(SAEnum(UserRole, name="user_role"))
    gender: Mapped[Optional[Gender]] = mapped_column(SAEnum(Gender, name="gender"), nullable=True)
    date_of_birth: Mapped[Optional[date]] = mapped_column(Date, nullable=True)
    profile_image_url: Mapped[Optional[str]] = mapped_column(String(500), nullable=True)

    is_active: Mapped[bool] = mapped_column(Boolean, default=True)
    is_email_verified: Mapped[bool] = mapped_column(Boolean, default=False)
    is_phone_verified: Mapped[bool] = mapped_column(Boolean, default=False)

    last_login_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True), nullable=True)

    # Relationships
    student_profile: Mapped["Student"] = relationship(back_populates="user", uselist=False)
    supervisor_profile: Mapped["Supervisor"] = relationship(back_populates="user", uselist=False)
    admin_profile: Mapped["Admin"] = relationship(back_populates="user", uselist=False)

    def __repr__(self) -> str:
        return f"<User id={self.id} email={self.email!r} role={self.user_role.value}>"

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\core\__init__.py ---
# models/core/__init__.py
from .user import User
from .hostel import Hostel
from .room import Room
from .bed import Bed
from .student import Student
from .supervisor import Supervisor
from .admin import Admin

__all__ = [
    "User",
    "Hostel",
    "Room",
    "Bed",
    "Student",
    "Supervisor",
    "Admin",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\core\__pycache__ =====


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\mixins =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\mixins\audit_mixin.py ---
# models/mixins/audit_mixin.py
from __future__ import annotations

from typing import Optional
from uuid import UUID

from sqlalchemy import ForeignKey
from sqlalchemy.orm import Mapped, mapped_column


class AuditMixin:
    """Basic audit trail fields (creator / updater)."""
    created_by_id: Mapped[Optional[UUID]] = mapped_column(
        ForeignKey("core_user.id", ondelete="SET NULL"),
        nullable=True,
    )
    updated_by_id: Mapped[Optional[UUID]] = mapped_column(
        ForeignKey("core_user.id", ondelete="SET NULL"),
        nullable=True,
    )

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\mixins\backend_sync_mixin.py ---
# models/mixins/backend_sync_mixin.py
from __future__ import annotations

from typing import Optional

from sqlalchemy import String
from sqlalchemy.orm import Mapped, mapped_column


class BackendSyncMixin:
    """For entities synchronized with a backend/external service."""
    backend_id: Mapped[Optional[str]] = mapped_column(
        String(100),
        nullable=True,
        unique=False,
    )

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\mixins\soft_delete_mixin.py ---
# models/mixins/soft_delete_mixin.py
from __future__ import annotations

from datetime import datetime
from typing import Optional

from sqlalchemy import Boolean, DateTime
from sqlalchemy.orm import Mapped, mapped_column


class SoftDeleteMixin:
    """Soft delete support."""
    is_deleted: Mapped[bool] = mapped_column(
        Boolean,
        default=False,
        nullable=False,
    )
    deleted_at: Mapped[Optional[datetime]] = mapped_column(
        DateTime(timezone=True),
        nullable=True,
    )

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\mixins\timestamp_mixin.py ---
# models/mixins/timestamp_mixin.py
from __future__ import annotations

from datetime import datetime

from sqlalchemy import DateTime, func
from sqlalchemy.orm import Mapped, mapped_column


class TimestampMixin:
    """created_at / updated_at mixin."""
    created_at: Mapped[datetime] = mapped_column(
        DateTime(timezone=True),
        server_default=func.now(),
        nullable=False,
    )
    updated_at: Mapped[datetime] = mapped_column(
        DateTime(timezone=True),
        server_default=func.now(),
        onupdate=func.now(),
        nullable=False,
    )

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\mixins\validation_mixin.py ---
# models/mixins/validation_mixin.py
from __future__ import annotations


class ValidationMixin:
    """
    Common validation hooks.

    Extend and override `validate` in concrete models
    (e.g., implement domain invariants).
    """

    def validate(self) -> None:
        """Raise exceptions if model state is invalid."""
        # No-op by default; override in subclasses.
        return

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\mixins\__init__.py ---
# models/mixins/__init__.py
from .timestamp_mixin import TimestampMixin
from .soft_delete_mixin import SoftDeleteMixin
from .audit_mixin import AuditMixin
from .validation_mixin import ValidationMixin
from .backend_sync_mixin import BackendSyncMixin

__all__ = [
    "TimestampMixin",
    "SoftDeleteMixin",
    "AuditMixin",
    "ValidationMixin",
    "BackendSyncMixin",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\mixins\__pycache__ =====


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\services =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\services\attendance.py ---
# app.models/services/attendance.py
from __future__ import annotations

from datetime import date, time
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, Enum as SAEnum, ForeignKey, String, Time, Boolean, Integer
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import AttendanceStatus, AttendanceMode
from app.models.base import BaseEntity


class Attendance(BaseEntity):
    """Attendance tracking."""
    __tablename__ = "svc_attendance"

    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)
    student_id: Mapped[UUID] = mapped_column(ForeignKey("core_student.id"), index=True)

    attendance_date: Mapped[date] = mapped_column(Date, index=True)

    check_in_time: Mapped[Optional[time]] = mapped_column(Time)
    check_out_time: Mapped[Optional[time]] = mapped_column(Time)

    status: Mapped[AttendanceStatus] = mapped_column(SAEnum(AttendanceStatus, name="attendance_status"))

    is_late: Mapped[bool] = mapped_column(Boolean, default=False)
    late_minutes: Mapped[Optional[int]] = mapped_column(Integer)

    attendance_mode: Mapped[AttendanceMode] = mapped_column(SAEnum(AttendanceMode, name="attendance_mode"))

    marked_by_id: Mapped[UUID] = mapped_column(ForeignKey("core_user.id"))
    supervisor_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_supervisor.id"), nullable=True)

    notes: Mapped[Optional[str]] = mapped_column(String(500))

    # Relationships (light)
    student: Mapped["Student"] = relationship()

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\services\complaint.py ---
# app.models/services/complaint.py
from __future__ import annotations

from datetime import datetime
from typing import Optional
from uuid import UUID

from sqlalchemy import DateTime, Enum as SAEnum, ForeignKey, JSON, String
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import ComplaintCategory, ComplaintStatus, Priority
from app.models.base import BaseEntity


class Complaint(BaseEntity):
    """Complaint tracking & resolution."""
    __tablename__ = "svc_complaint"

    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)
    raised_by_id: Mapped[UUID] = mapped_column(ForeignKey("core_user.id"), index=True)
    student_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_student.id"), nullable=True)

    title: Mapped[str] = mapped_column(String(255))
    description: Mapped[str] = mapped_column(String(2000))

    category: Mapped[ComplaintCategory] = mapped_column(SAEnum(ComplaintCategory, name="complaint_category"))
    sub_category: Mapped[Optional[str]] = mapped_column(String(100))
    priority: Mapped[Priority] = mapped_column(SAEnum(Priority, name="priority"))

    room_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_room.id"), nullable=True)
    location_details: Mapped[Optional[str]] = mapped_column(String(500))

    attachments: Mapped[list[str]] = mapped_column(JSON, default=list)

    status: Mapped[ComplaintStatus] = mapped_column(SAEnum(ComplaintStatus, name="complaint_status"))
    assigned_to_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_supervisor.id"), nullable=True)

    opened_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), default=datetime.utcnow)
    in_progress_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    resolved_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    closed_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

    sla_breach: Mapped[bool] = mapped_column(default=False)
    sla_breach_reason: Mapped[Optional[str]] = mapped_column(String(500))

    # Relationships (light)
    hostel: Mapped["Hostel"] = relationship()
    raised_by: Mapped["User"] = relationship()
    assigned_to: Mapped[Optional["Supervisor"]] = relationship()

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\services\inquiry.py ---
# app.models/services/inquiry.py
from __future__ import annotations

from datetime import datetime, date
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, DateTime, Enum as SAEnum, ForeignKey, String
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import InquiryStatus, RoomType
from app.models.base import BaseEntity


class Inquiry(BaseEntity):
    """Visitor inquiries about hostels."""
    __tablename__ = "svc_inquiry"

    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)

    visitor_name: Mapped[str] = mapped_column(String(255))
    visitor_email: Mapped[str] = mapped_column(String(255))
    visitor_phone: Mapped[str] = mapped_column(String(20))

    preferred_check_in_date: Mapped[Optional[date]] = mapped_column(Date)
    stay_duration_months: Mapped[Optional[int]]
    room_type_preference: Mapped[Optional[RoomType]] = mapped_column(
        SAEnum(RoomType, name="inquiry_room_type"),
        nullable=True,
    )

    message: Mapped[Optional[str]] = mapped_column(String(2000))

    inquiry_source: Mapped[str] = mapped_column(String(50))
    status: Mapped[InquiryStatus] = mapped_column(SAEnum(InquiryStatus, name="inquiry_status"))

    contacted_by_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_admin.id"))
    contacted_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

    notes: Mapped[Optional[str]] = mapped_column(String(1000))

    hostel: Mapped["Hostel"] = relationship()

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\services\leave_application.py ---
# app.models/services/leave_application.py
from __future__ import annotations

from datetime import date
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, Enum as SAEnum, ForeignKey, Integer, String
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import LeaveType, LeaveStatus
from app.models.base import BaseEntity


class LeaveApplication(BaseEntity):
    """Student leave requests."""
    __tablename__ = "svc_leave_application"

    student_id: Mapped[UUID] = mapped_column(ForeignKey("core_student.id"), index=True)
    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)

    leave_type: Mapped[LeaveType] = mapped_column(SAEnum(LeaveType, name="leave_type"))
    from_date: Mapped[date] = mapped_column(Date)
    to_date: Mapped[date] = mapped_column(Date)
    total_days: Mapped[int] = mapped_column(Integer)

    reason: Mapped[str] = mapped_column(String(1000))

    contact_during_leave: Mapped[Optional[str]] = mapped_column(String(20))
    emergency_contact: Mapped[Optional[str]] = mapped_column(String(20))

    supporting_document_url: Mapped[Optional[str]] = mapped_column(String(500))

    status: Mapped[LeaveStatus] = mapped_column(SAEnum(LeaveStatus, name="leave_status"))

    approved_by_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_supervisor.id"))
    rejected_by_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_supervisor.id"))

    rejection_reason: Mapped[Optional[str]] = mapped_column(String(500))
    cancellation_reason: Mapped[Optional[str]] = mapped_column(String(500))

    # Relationships
    student: Mapped["Student"] = relationship()

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\services\maintenance.py ---
# app.models/services/maintenance.py
from __future__ import annotations

from datetime import date, datetime
from decimal import Decimal
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, DateTime, Enum as SAEnum, ForeignKey, JSON, Numeric, String, Boolean
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import (
    MaintenanceCategory,
    MaintenanceStatus,
    MaintenanceIssueType,
    Priority,
)
from app.models.base import BaseEntity


class Maintenance(BaseEntity):
    """Maintenance requests & work orders."""
    __tablename__ = "svc_maintenance"

    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)
    requested_by_id: Mapped[UUID] = mapped_column(ForeignKey("core_user.id"))
    room_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_room.id"), nullable=True)

    title: Mapped[str] = mapped_column(String(255))
    description: Mapped[str] = mapped_column(String(2000))

    category: Mapped[MaintenanceCategory] = mapped_column(SAEnum(MaintenanceCategory, name="maintenance_category"))
    priority: Mapped[Priority] = mapped_column(SAEnum(Priority, name="maintenance_priority"))
    issue_type: Mapped[MaintenanceIssueType] = mapped_column(
        SAEnum(MaintenanceIssueType, name="maintenance_issue_type")
    )

    location: Mapped[Optional[str]] = mapped_column(String(500))
    floor: Mapped[Optional[int]] = mapped_column()
    specific_area: Mapped[Optional[str]] = mapped_column(String(255))

    issue_photos: Mapped[list[str]] = mapped_column(JSON, default=list)

    status: Mapped[MaintenanceStatus] = mapped_column(SAEnum(MaintenanceStatus, name="maintenance_status"))
    assigned_to_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_supervisor.id"), nullable=True)

    estimated_cost: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    actual_cost: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))

    estimated_completion_date: Mapped[Optional[date]] = mapped_column(Date)
    actual_completion_date: Mapped[Optional[date]] = mapped_column(Date)

    cost_approved: Mapped[bool] = mapped_column(Boolean, default=False)
    approval_threshold_exceeded: Mapped[bool] = mapped_column(Boolean, default=False)

    started_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    completed_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\services\__init__.py ---
# models/services/__init__.py
from .complaint import Complaint
from .maintenance import Maintenance
from .attendance import Attendance
from .leave_application import LeaveApplication
from .inquiry import Inquiry

__all__ = [
    "Complaint",
    "Maintenance",
    "Attendance",
    "LeaveApplication",
    "Inquiry",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\services\__pycache__ =====


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\system =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\system\feature_flags.py ---
# app.models/system/feature_flags.py
from __future__ import annotations

from datetime import datetime
from typing import Optional
from uuid import UUID

from sqlalchemy import Boolean, DateTime, String
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class FeatureFlag(BaseItem):
    """Feature toggles."""
    __tablename__ = "sys_feature_flag"

    name: Mapped[str] = mapped_column(String(100), unique=True)
    description: Mapped[Optional[str]] = mapped_column(String(500))

    is_enabled: Mapped[bool] = mapped_column(Boolean, default=False)

    # optional rollout
    rollout_percentage: Mapped[Optional[int]] = mapped_column()
    last_updated_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\system\notification.py ---


# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\system\platform_config.py ---
# app.models/system/platform_config.py
from __future__ import annotations

from uuid import UUID

from sqlalchemy import String
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class PlatformConfig(BaseItem):
    """
    Platform settings (branding, support info, theme colors).
    Typically one row.
    """
    __tablename__ = "sys_platform_config"

    portal_title: Mapped[str] = mapped_column(String(255))
    welcome_message: Mapped[str] = mapped_column(String(1000))

    support_email: Mapped[str] = mapped_column(String(255))
    support_phone: Mapped[str] = mapped_column(String(20))

    primary_color: Mapped[str] = mapped_column(String(20))
    secondary_color: Mapped[str] = mapped_column(String(20))
    text_color: Mapped[str] = mapped_column(String(20))
    accent_color: Mapped[str] = mapped_column(String(20))
    surface_color: Mapped[str] = mapped_column(String(20))

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\system\system_settings.py ---
# app.models/system/system_settings.py
from __future__ import annotations

from typing import Dict, Any
from uuid import UUID

from sqlalchemy import JSON, String
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class SystemSettings(BaseItem):
    """
    Arbitrary system-wide key/value settings.
    """
    __tablename__ = "sys_settings"

    key: Mapped[str] = mapped_column(String(100), unique=True)
    value: Mapped[Dict[str, Any]] = mapped_column(JSON, default=dict)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\system\__init__.py ---
# models/system/__init__.py
from .platform_config import PlatformConfig
from .notification import NotificationConfig
from .system_settings import SystemSettings
from .feature_flags import FeatureFlag

__all__ = [
    "PlatformConfig",
    "NotificationConfig",
    "SystemSettings",
    "FeatureFlag",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\transactions =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\transactions\booking.py ---
# app.models/transactions/booking.py
from __future__ import annotations

from datetime import date, datetime
from decimal import Decimal
from typing import List, Optional
from uuid import UUID

from sqlalchemy import Date, DateTime, Enum as SAEnum, ForeignKey, Integer, Numeric, String, Boolean
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import BookingStatus, RoomType, BookingSource
from app.models.base import BaseEntity


class Booking(BaseEntity):
    """
    Internal booking requests (from visitor or admin).
    """
    __tablename__ = "txn_booking"

    visitor_id: Mapped[UUID] = mapped_column(ForeignKey("visitor.id"), index=True)
    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)

    room_type_requested: Mapped[RoomType] = mapped_column(SAEnum(RoomType, name="room_type"))
    preferred_check_in_date: Mapped[date] = mapped_column(Date)
    stay_duration_months: Mapped[int] = mapped_column(Integer)

    quoted_rent_monthly: Mapped[Decimal] = mapped_column(Numeric(10, 2))
    total_amount: Mapped[Decimal] = mapped_column(Numeric(10, 2))
    security_deposit: Mapped[Decimal] = mapped_column(Numeric(10, 2))
    advance_amount: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)

    booking_status: Mapped[BookingStatus] = mapped_column(SAEnum(BookingStatus, name="booking_status"))

    source: Mapped[BookingSource] = mapped_column(SAEnum(BookingSource, name="booking_source"))
    referral_code: Mapped[Optional[str]] = mapped_column(String(50))

    booking_date: Mapped[datetime] = mapped_column(DateTime(timezone=True), default=datetime.utcnow)
    expires_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

    # Guest summary
    guest_name: Mapped[str] = mapped_column(String(255))
    guest_email: Mapped[str] = mapped_column(String(255))
    guest_phone: Mapped[str] = mapped_column(String(20))

    # Assignment (optional)
    room_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_room.id"))
    bed_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_bed.id"))

    # Relationships
    payments: Mapped[List["Payment"]] = relationship(back_populates="booking")

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\transactions\fee_structure.py ---
# app.models/transactions/fee_structure.py
from __future__ import annotations

from datetime import date
from decimal import Decimal
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, Enum as SAEnum, ForeignKey, Numeric
from sqlalchemy.orm import Mapped, mapped_column

from app.schemas.common.enums import RoomType, FeeType, ChargeType
from app.models.base import BaseEntity


class FeeStructure(BaseEntity):
    """Fee configuration per hostel & room type."""
    __tablename__ = "cfg_fee_structure"

    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)
    room_type: Mapped[RoomType] = mapped_column(SAEnum(RoomType, name="room_type"))
    fee_type: Mapped[FeeType] = mapped_column(SAEnum(FeeType, name="fee_type"))

    amount: Mapped[Decimal] = mapped_column(Numeric(10, 2))
    security_deposit: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)

    includes_mess: Mapped[bool] = mapped_column(default=False)
    mess_charges_monthly: Mapped[Decimal] = mapped_column(Numeric(10, 2), default=0)

    electricity_charges: Mapped[ChargeType] = mapped_column(SAEnum(ChargeType, name="charge_type"))
    electricity_fixed_amount: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))

    water_charges: Mapped[ChargeType] = mapped_column(SAEnum(ChargeType, name="water_charge_type"))
    water_fixed_amount: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))

    effective_from: Mapped[date] = mapped_column(Date)
    effective_to: Mapped[Optional[date]] = mapped_column(Date)
    is_active: Mapped[bool] = mapped_column(default=True)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\transactions\payment.py ---
# app.models/transactions/payment.py
from __future__ import annotations

from datetime import date, datetime
from decimal import Decimal
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, DateTime, Enum as SAEnum, ForeignKey, Numeric, String
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.schemas.common.enums import PaymentType, PaymentMethod, PaymentStatus
from app.models.base import BaseEntity


class Payment(BaseEntity):
    """Unified Payment model."""
    __tablename__ = "txn_payment"

    payer_id: Mapped[UUID] = mapped_column(ForeignKey("core_user.id"), index=True)
    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)
    student_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_student.id"), nullable=True)
    booking_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("txn_booking.id"), nullable=True)

    payment_type: Mapped[PaymentType] = mapped_column(SAEnum(PaymentType, name="payment_type"))
    amount: Mapped[Decimal] = mapped_column(Numeric(10, 2))
    currency: Mapped[str] = mapped_column(String(3), default="INR")

    payment_period_start: Mapped[Optional[date]] = mapped_column(Date)
    payment_period_end: Mapped[Optional[date]] = mapped_column(Date)

    payment_method: Mapped[PaymentMethod] = mapped_column(SAEnum(PaymentMethod, name="payment_method"))
    payment_gateway: Mapped[Optional[str]] = mapped_column(String(50))

    payment_status: Mapped[PaymentStatus] = mapped_column(SAEnum(PaymentStatus, name="payment_status"))
    transaction_id: Mapped[Optional[str]] = mapped_column(String(100))

    due_date: Mapped[Optional[date]] = mapped_column(Date)
    paid_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    failed_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    failure_reason: Mapped[Optional[str]] = mapped_column(String(500))

    receipt_number: Mapped[Optional[str]] = mapped_column(String(100))
    receipt_url: Mapped[Optional[str]] = mapped_column(String(500))

    # Relationships
    booking: Mapped[Optional["Booking"]] = relationship(back_populates="payments")

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\transactions\referral.py ---
# app.models/transactions/referral.py
from __future__ import annotations

from datetime import datetime, date
from decimal import Decimal
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, DateTime, Enum as SAEnum, ForeignKey, Numeric, String
from sqlalchemy.orm import Mapped, mapped_column

from app.schemas.common.enums import ReferralStatus, RewardStatus
from app.models.base import BaseItem


class ReferralProgram(BaseItem):
    """Referral program definition."""
    __tablename__ = "ref_program"

    program_name: Mapped[str] = mapped_column(String(100))
    program_type: Mapped[str] = mapped_column(String(50))  # student_referral, visitor_referral, etc.

    reward_type: Mapped[str] = mapped_column(String(50))   # cash, discount, etc.
    referrer_reward_amount: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    referee_reward_amount: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    currency: Mapped[str] = mapped_column(String(3), default="INR")

    min_booking_amount: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    min_stay_months: Mapped[Optional[int]] = mapped_column()

    terms_and_conditions: Mapped[Optional[str]] = mapped_column(String(5000))

    is_active: Mapped[bool] = mapped_column(default=True)
    valid_from: Mapped[Optional[date]] = mapped_column(Date)
    valid_to: Mapped[Optional[date]] = mapped_column(Date)


class Referral(BaseItem):
    """Individual referral record."""
    __tablename__ = "ref_referral"

    program_id: Mapped[UUID] = mapped_column(ForeignKey("ref_program.id"), index=True)
    referrer_id: Mapped[UUID] = mapped_column(ForeignKey("core_user.id"), index=True)

    referee_email: Mapped[Optional[str]] = mapped_column(String(255))
    referee_phone: Mapped[Optional[str]] = mapped_column(String(20))
    referee_user_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_user.id"))

    referral_code: Mapped[str] = mapped_column(String(50), index=True)
    status: Mapped[ReferralStatus] = mapped_column(SAEnum(ReferralStatus, name="referral_status"))

    booking_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("txn_booking.id"))
    completed_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

    referrer_reward_amount: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    referee_reward_amount: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    currency: Mapped[str] = mapped_column(String(3), default="INR")

    referrer_reward_status: Mapped[RewardStatus] = mapped_column(SAEnum(RewardStatus, name="reward_status"))
    referee_reward_status: Mapped[RewardStatus] = mapped_column(SAEnum(RewardStatus, name="reward_status_ref"))

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\transactions\subscription.py ---
# app.models/transactions/subscription.py
from __future__ import annotations

from datetime import date
from decimal import Decimal
from typing import Dict, Optional
from uuid import UUID

from sqlalchemy import Date, Enum as SAEnum, JSON, Numeric, String, Boolean, ForeignKey
from sqlalchemy.orm import Mapped, mapped_column

from app.schemas.common.enums import SubscriptionStatus, BillingCycle, SubscriptionPlan
from app.models.base import BaseItem


class SubscriptionPlan(BaseItem):
    """Subscription plan definition."""
    __tablename__ = "sub_plan"

    plan_name: Mapped[str] = mapped_column(String(100), unique=True)
    display_name: Mapped[str] = mapped_column(String(100))
    plan_type: Mapped[SubscriptionPlan] = mapped_column(SAEnum(SubscriptionPlan, name="subscription_plan"))

    description: Mapped[Optional[str]] = mapped_column(String(1000))

    price_monthly: Mapped[Decimal] = mapped_column(Numeric(10, 2))
    price_yearly: Mapped[Decimal] = mapped_column(Numeric(10, 2))
    currency: Mapped[str] = mapped_column(String(3), default="INR")

    features: Mapped[Dict[str, object]] = mapped_column(JSON, default=dict)

    max_hostels: Mapped[Optional[int]] = mapped_column()
    max_rooms_per_hostel: Mapped[Optional[int]] = mapped_column()
    max_students: Mapped[Optional[int]] = mapped_column()

    is_active: Mapped[bool] = mapped_column(Boolean, default=True)
    is_public: Mapped[bool] = mapped_column(Boolean, default=True)
    sort_order: Mapped[int] = mapped_column(default=0)


class Subscription(BaseItem):
    """Hostel subscription instance."""
    __tablename__ = "sub_subscription"

    hostel_id: Mapped[UUID] = mapped_column(ForeignKey("core_hostel.id"), index=True)
    plan_id: Mapped[UUID] = mapped_column(ForeignKey("sub_plan.id"), index=True)

    subscription_reference: Mapped[str] = mapped_column(String(100), unique=True)

    billing_cycle: Mapped[BillingCycle] = mapped_column(SAEnum(BillingCycle, name="billing_cycle"))
    amount: Mapped[Decimal] = mapped_column(Numeric(10, 2))
    currency: Mapped[str] = mapped_column(String(3), default="INR")

    start_date: Mapped[date] = mapped_column(Date)
    end_date: Mapped[date] = mapped_column(Date)

    auto_renew: Mapped[bool] = mapped_column(Boolean, default=True)
    next_billing_date: Mapped[Optional[date]] = mapped_column(Date)

    status: Mapped[SubscriptionStatus] = mapped_column(SAEnum(SubscriptionStatus, name="subscription_status"))

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\transactions\__init__.py ---
# models/transactions/__init__.py
from .payment import Payment
from .booking import Booking
from .fee_structure import FeeStructure
from .subscription import Subscription, SubscriptionPlan
from .referral import Referral, ReferralProgram

__all__ = [
    "Payment",
    "Booking",
    "FeeStructure",
    "Subscription",
    "SubscriptionPlan",
    "Referral",
    "ReferralProgram",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\transactions\__pycache__ =====


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\visitor =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\visitor\hostel_booking.py ---
# app.models/visitor/hostel_booking.py
from __future__ import annotations

from datetime import date, datetime
from decimal import Decimal
from typing import Optional
from uuid import UUID

from sqlalchemy import Date, DateTime, Integer, Numeric, String
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.models.base import BaseVisitorItem


class HostelBooking(BaseVisitorItem):
    """Visitor booking for a hostel."""
    __tablename__ = "visitor_hostel_booking"

    visitor_id: Mapped[UUID] = mapped_column(index=True)
    hostel_id: Mapped[UUID] = mapped_column(index=True)

    check_in_date: Mapped[date] = mapped_column(Date)
    check_out_date: Mapped[date] = mapped_column(Date)
    duration: Mapped[str] = mapped_column(String(50))

    room_type: Mapped[str] = mapped_column(String(50))
    number_of_beds: Mapped[int] = mapped_column(Integer)

    monthly_rent: Mapped[Decimal] = mapped_column(Numeric(10, 2))
    security_deposit: Mapped[Decimal] = mapped_column(Numeric(10, 2))
    total_amount: Mapped[Decimal] = mapped_column(Numeric(10, 2))

    booking_status: Mapped[str] = mapped_column(String(50), index=True)

    confirmed_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    checked_in_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    checked_out_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    cancelled_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))
    cancellation_reason: Mapped[Optional[str]] = mapped_column(String(500))

    special_requests: Mapped[Optional[str]] = mapped_column(String(1000))
    guest_count: Mapped[int] = mapped_column(Integer, default=1)

    # you might add a relationship to Payment later (1:1)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\visitor\hostel_review.py ---
# app.models/visitor/hostel_review.py
from __future__ import annotations

from datetime import datetime
from decimal import Decimal
from typing import List, Optional
from uuid import UUID

from sqlalchemy import Boolean, DateTime, Float, Integer, JSON, String
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseVisitorItem


class HostelReview(BaseVisitorItem):
    """Visitor review of a hostel (public side)."""
    __tablename__ = "visitor_hostel_review"

    visitor_id: Mapped[UUID] = mapped_column(index=True)
    hostel_id: Mapped[UUID] = mapped_column(index=True)
    booking_id: Mapped[Optional[UUID]] = mapped_column(index=True)

    overall_rating: Mapped[float] = mapped_column(Float)
    cleanliness_rating: Mapped[Optional[float]] = mapped_column(Float)
    food_rating: Mapped[Optional[float]] = mapped_column(Float)
    staff_rating: Mapped[Optional[float]] = mapped_column(Float)
    location_rating: Mapped[Optional[float]] = mapped_column(Float)

    review_title: Mapped[str] = mapped_column(String(255))
    review_text: Mapped[str] = mapped_column(String(5000))

    is_verified: Mapped[bool] = mapped_column(Boolean, default=False)
    helpful_count: Mapped[int] = mapped_column(Integer, default=0)

    photos: Mapped[List[str]] = mapped_column(JSON, default=list)
    hostel_response: Mapped[Optional[str]] = mapped_column(String(5000))
    response_date: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\visitor\visitor.py ---
# app.models/visitor/visitor.py
from __future__ import annotations

from decimal import Decimal
from typing import List, Optional
from uuid import UUID

from sqlalchemy import Boolean, JSON, Numeric
from sqlalchemy.orm import Mapped, mapped_column

from app.schemas.common.enums import RoomType
from app.models.base import BaseVisitorItem


class Visitor(BaseVisitorItem):
    """Visitor profile for public platform."""
    __tablename__ = "visitor"

    user_id: Mapped[UUID] = mapped_column(unique=True, index=True)

    preferred_room_type: Mapped[Optional[RoomType]] = mapped_column(
        nullable=True
    )
    budget_min: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    budget_max: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))

    preferred_cities: Mapped[List[str]] = mapped_column(JSON, default=list)
    preferred_amenities: Mapped[List[str]] = mapped_column(JSON, default=list)

    favorite_hostel_ids: Mapped[List[UUID]] = mapped_column(JSON, default=list)

    email_notifications: Mapped[bool] = mapped_column(Boolean, default=True)
    sms_notifications: Mapped[bool] = mapped_column(Boolean, default=True)
    push_notifications: Mapped[bool] = mapped_column(Boolean, default=True)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\visitor\visitor_hostel.py ---
# app.models/visitor/visitor_hostel.py
from __future__ import annotations

from decimal import Decimal
from typing import List, Optional
from uuid import UUID

from sqlalchemy import Float, Integer, JSON, Numeric, String
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseVisitorItem


class VisitorHostel(BaseVisitorItem):
    """
    Public-facing hostel representation used by search/visitor side.
    Often denormalized from core_hostel.
    """
    __tablename__ = "visitor_hostel"

    hostel_id: Mapped[UUID] = mapped_column(index=True)

    hostel_name: Mapped[str] = mapped_column(String(255))
    description: Mapped[Optional[str]] = mapped_column(String(2000))
    location: Mapped[str] = mapped_column(String(255))
    city: Mapped[str] = mapped_column(String(100))
    area: Mapped[Optional[str]] = mapped_column(String(100))
    pincode: Mapped[str] = mapped_column(String(6))

    price_range: Mapped[str] = mapped_column(String(50))
    min_price: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))
    max_price: Mapped[Optional[Decimal]] = mapped_column(Numeric(10, 2))

    room_types: Mapped[List[str]] = mapped_column(JSON, default=list)
    gender_type: Mapped[str] = mapped_column(String(20))

    availability: Mapped[int] = mapped_column(Integer)
    total_capacity: Mapped[int] = mapped_column(Integer)

    rating: Mapped[float] = mapped_column(Float, default=0.0)
    total_reviews: Mapped[int] = mapped_column(Integer, default=0)

    amenities: Mapped[List[str]] = mapped_column(JSON, default=list)
    photos: Mapped[List[str]] = mapped_column(JSON, default=list)

    contact_number: Mapped[str] = mapped_column(String(20))
    contact_email: Mapped[Optional[str]] = mapped_column(String(255))

    nearby_landmarks: Mapped[Optional[str]] = mapped_column(String(1000))
    availability_status: Mapped[str] = mapped_column(String(50))

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\visitor\__init__.py ---
# models/visitor/__init__.py
from .visitor import Visitor
from .visitor_hostel import VisitorHostel
from .hostel_booking import HostelBooking
from .hostel_review import HostelReview

__all__ = [
    "Visitor",
    "VisitorHostel",
    "HostelBooking",
    "HostelReview",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\visitor\__pycache__ =====


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\workflows =====

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\workflows\approval_workflow.py ---
# app.models/workflows/approval_workflow.py
from __future__ import annotations

from datetime import datetime
from typing import Optional
from uuid import UUID

from sqlalchemy import DateTime, String, ForeignKey
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class ApprovalWorkflow(BaseItem):
    """
    Generic approval workflow for entities that need admin/supervisor approval
    (announcements, menus, large maintenance, etc.).
    """
    __tablename__ = "wf_approval"

    entity_type: Mapped[str] = mapped_column(String(50))  # complaint, maintenance, announcement, menu, etc.
    entity_id: Mapped[UUID] = mapped_column()

    status: Mapped[str] = mapped_column(String(50))  # pending, approved, rejected
    requested_by_id: Mapped[UUID] = mapped_column(ForeignKey("core_user.id"))
    approver_id: Mapped[Optional[UUID]] = mapped_column(ForeignKey("core_user.id"))

    requested_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), default=datetime.utcnow)
    decided_at: Mapped[Optional[datetime]] = mapped_column(DateTime(timezone=True))

    reason: Mapped[Optional[str]] = mapped_column()
    decision_notes: Mapped[Optional[str]] = mapped_column()

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\workflows\booking_workflow.py ---
# app.models/workflows/booking_workflow.py
from __future__ import annotations

from datetime import datetime
from uuid import UUID

from sqlalchemy import DateTime, String, ForeignKey
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class BookingWorkflow(BaseItem):
    """Booking approval & lifecycle states."""
    __tablename__ = "wf_booking"

    booking_id: Mapped[UUID] = mapped_column(ForeignKey("txn_booking.id"), unique=True)

    current_status: Mapped[str] = mapped_column(String(50))  # pending, approved, rejected, checked_in, checked_out
    last_updated_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), default=datetime.utcnow)

    # optionally store JSON state history externally

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\workflows\complaint_workflow.py ---
# app.models/workflows/complaint_workflow.py
from __future__ import annotations

from datetime import datetime
from uuid import UUID

from sqlalchemy import DateTime, String, ForeignKey
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class ComplaintWorkflow(BaseItem):
    """Complaint resolution workflow state."""
    __tablename__ = "wf_complaint"

    complaint_id: Mapped[UUID] = mapped_column(ForeignKey("svc_complaint.id"), unique=True)

    current_status: Mapped[str] = mapped_column(String(50))  # open, in_progress, resolved, closed, escalated
    last_updated_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), default=datetime.utcnow)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\workflows\maintenance_workflow.py ---
# app.models/workflows/maintenance_workflow.py
from __future__ import annotations

from datetime import datetime
from uuid import UUID

from sqlalchemy import DateTime, String, ForeignKey
from sqlalchemy.orm import Mapped, mapped_column

from app.models.base import BaseItem


class MaintenanceWorkflow(BaseItem):
    """Maintenance approval & execution workflow."""
    __tablename__ = "wf_maintenance"

    maintenance_id: Mapped[UUID] = mapped_column(ForeignKey("svc_maintenance.id"), unique=True)

    current_status: Mapped[str] = mapped_column(String(50))  # pending_approval, approved, in_progress, completed
    last_updated_at: Mapped[datetime] = mapped_column(DateTime(timezone=True), default=datetime.utcnow)

# --- File: D:\Last Github Push\Last\Hostel-Main\app\models\workflows\__init__.py ---
# models/workflows/__init__.py
from .booking_workflow import BookingWorkflow
from .complaint_workflow import ComplaintWorkflow
from .maintenance_workflow import MaintenanceWorkflow
from .approval_workflow import ApprovalWorkflow

__all__ = [
    "BookingWorkflow",
    "ComplaintWorkflow",
    "MaintenanceWorkflow",
    "ApprovalWorkflow",
]


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\workflows\__pycache__ =====


# ===== Folder: D:\Last Github Push\Last\Hostel-Main\app\models\__pycache__ =====
